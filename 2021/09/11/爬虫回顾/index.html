<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Dary的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210">
<meta property="og:type" content="article">
<meta property="og:title" content="Dary的博客">
<meta property="og:url" content="http://dary.work/2021/09/11/%E7%88%AC%E8%99%AB%E5%9B%9E%E9%A1%BE/index.html">
<meta property="og:site_name" content="Dary的博客">
<meta property="og:description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210">
<meta property="og:locale">
<meta property="article:published_time" content="2021-09-11T06:29:14.677Z">
<meta property="article:modified_time" content="2021-08-23T11:01:13.413Z">
<meta property="article:author" content="Dary">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Dary的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Dary的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://dary.work"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-爬虫回顾" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC%E8%99%AB%E5%9B%9E%E9%A1%BE/" class="article-date">
  <time datetime="2021-09-11T06:29:14.677Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 爬虫的合法性探讨</span><br><span class="line">    ~ 法不禁止即为许可</span><br><span class="line">    ~ robots协议</span><br><span class="line">    ~ 隐匿身份</span><br><span class="line">        - 高匿商业代理</span><br><span class="line">        - TOR（洋葱路由）</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 爬虫的分类</span><br><span class="line">    ~ 通用爬虫</span><br><span class="line">    ~ 定向爬虫</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 爬虫程序的一般步骤</span><br><span class="line">    URL ---&gt; Universal Resource Locator</span><br><span class="line">    URI ---&gt; Universal Resource Identifier</span><br><span class="line">    URI = URL + URN</span><br><span class="line">    协议://用户名:口令@域名或IP地址:端口/路径<span class="number">1</span>/路径<span class="number">2</span>/资源名称</span><br><span class="line">    https://www.baidu.com:<span class="number">443</span>/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png</span><br><span class="line"></span><br><span class="line">    HTTP / HTTPS ---&gt; 超文本传输协议</span><br><span class="line"></span><br><span class="line">    HTTP请求 --------&gt; 服务器</span><br><span class="line">        请求行 - 命令（GET/POST） 资源路径 协议版本</span><br><span class="line">        请求头 - 键值对</span><br><span class="line">        空行</span><br><span class="line">        消息体 - 发给服务器的数据</span><br><span class="line"></span><br><span class="line">    HTTP响应 &lt;-------- 服务器</span><br><span class="line">        响应行 - 协议版本 响应状态码</span><br><span class="line">        响应头 - 键值对</span><br><span class="line">            ~ content-<span class="built_in">type</span> ---&gt; MIME</span><br><span class="line">                - text/html</span><br><span class="line">                - application/json</span><br><span class="line">                - text/xml</span><br><span class="line">                - application/pdf</span><br><span class="line">                - image/jpeg</span><br><span class="line">                - image/png</span><br><span class="line">        空行</span><br><span class="line">        消息体 - 服务器返回的数据</span><br><span class="line"></span><br><span class="line">    ~ 抓取页面</span><br><span class="line">        - urllib</span><br><span class="line">        - requests</span><br><span class="line">            get() / post() ---&gt; Response ---&gt; text / content / json()</span><br><span class="line">            Session ---&gt; get() / post()</span><br><span class="line">    ~ 解析页面</span><br><span class="line">    ~ 数据持久化</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> HTML页面的结构</span><br><span class="line">    超文本标签语言 ---&gt; 所有的内容都放在标签下</span><br><span class="line"></span><br><span class="line">    ~ 标签：承载内容</span><br><span class="line">        &lt;p&gt; / &lt;h1&gt; / &lt;a&gt; / &lt;img&gt; / &lt;li&gt;</span><br><span class="line">    ~ CSS（Cascading Style Sheet）：页面渲染</span><br><span class="line">        选择器 ---&gt; 样式属性名: 样式属性值</span><br><span class="line">        - 标签选择器</span><br><span class="line">        - 类选择器</span><br><span class="line">        - ID选择器</span><br><span class="line">        - 父子选择器 ---&gt; div &gt; p</span><br><span class="line">        - 后代选择器 ---&gt; div p</span><br><span class="line">        - 兄弟选择器 ---&gt; div ~ p</span><br><span class="line">        - 相邻兄弟选择器 ---&gt; div + p</span><br><span class="line">        - 伪类/伪元素 ---&gt; a:visited / p:first-letter</span><br><span class="line">    ~ JavaScript（JS）：交互式行为</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 解析页面的三种方式</span><br><span class="line">    ~ 正则表达式解析 ---&gt; re</span><br><span class="line">        - 直接调用re模块的函数</span><br><span class="line">            ~ search / findall / finditer</span><br><span class="line">        - 创建Pattern对象，给对象发消息</span><br><span class="line">            ~ <span class="built_in">compile</span> ---&gt; Pattern</span><br><span class="line">            ~ search ---&gt; Match ---&gt; group()</span><br><span class="line">            ~ findall / finditer</span><br><span class="line">    ~ CSS选择器解析</span><br><span class="line">        - BeautifulSoup ---&gt; beautifulsoup4 ---&gt; <span class="keyword">import</span> bs4</span><br><span class="line">        - PyQuery ---&gt; pip install pyquery ---&gt; 有jQuery使用经验</span><br><span class="line">    ~ XPath解析</span><br><span class="line">        - lxml ---&gt; pip install lxml</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"><span class="number">6.</span> 数据持久化</span><br><span class="line">    ~ CSV文件</span><br><span class="line">    ~ Excel文件</span><br><span class="line">    ~ 数据库</span><br><span class="line">    ~ 大数据平台</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 常见的反爬方式及破解</span><br><span class="line">    ~ 请求头检查</span><br><span class="line">        - User-Agent</span><br><span class="line">        - Referer ---&gt; 网站防盗链接</span><br><span class="line">        - Accept</span><br><span class="line">        - Accept-Language</span><br><span class="line">        - Accept-Encoding</span><br><span class="line">    ~ 限速和封禁IP</span><br><span class="line">        - 商业IP代理 ---&gt; 蘑菇代理 / 芝麻代理 / 快代理 / 讯代理 / 阿布云代理</span><br><span class="line">        - 代理池（提前放置好一堆代理，有对应的维护机制，能够动态替换掉失效代理）</span><br><span class="line">    ~ 身份验证</span><br><span class="line">        - 服务器如何识别你是否登录？</span><br><span class="line">            ~ 从请求中获取用户的身份标识</span><br><span class="line">            ~ 对于登录成功的用户，服务器通常会将用户身份标识写入浏览器本地存储</span><br><span class="line">                - Cookie</span><br><span class="line">                - localStorage / sessionStorage</span><br><span class="line">                - IndexedDB</span><br><span class="line">                ---&gt; 下次请求要带上自己的身份标识（修改请求头、修改Cookie信息）</span><br><span class="line">        - Cookie池（提前准备好多个登录用户的身份信息，轮换着使用）</span><br><span class="line">    ~ 动态内容</span><br><span class="line">        - 抓取接口</span><br><span class="line">            ~ 浏览器开发者工具 ---&gt; Network ---&gt; Fetch/XHR（异步请求）</span><br><span class="line">            ~ 专业（HTTP）抓包工具</span><br><span class="line">                - Charles / Fiddler ---&gt; 将它设置为浏览器的代理</span><br><span class="line">                - WireShark ---&gt; Ethereal ---&gt; 协议分析工具</span><br><span class="line">        - Selenium WebDriver ---&gt; 用代码驱动浏览器</span><br><span class="line">        - Puppeteer ---&gt; Pyppeteer ---&gt; Chromium</span><br><span class="line">    ~ 爬虫蜜罐</span><br><span class="line">        - Selenium ---&gt; WebElement ---&gt; is_displayed()</span><br><span class="line">    ~ 验证码</span><br><span class="line">        CAPTCHA ---&gt; 图灵测试</span><br><span class="line">        OCR ---&gt; Optical Character Recognition</span><br><span class="line">        teseract ---&gt; pytesseract</span><br><span class="line"></span><br><span class="line">        - easyocr</span><br><span class="line">        - 打码平台</span><br><span class="line">    ~ 字体反爬</span><br><span class="line">    ~ JS加密和混淆</span><br><span class="line"><span class="number">6.</span> 数据持久化</span><br><span class="line">    ~ CSV文件</span><br><span class="line">    ~ Excel文件</span><br><span class="line">    ~ 数据库</span><br><span class="line">    ~ 大数据平台</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 常见的反爬方式及破解</span><br><span class="line">    ~ 请求头检查</span><br><span class="line">        - User-Agent</span><br><span class="line">        - Referer ---&gt; 网站防盗链接</span><br><span class="line">        - Accept</span><br><span class="line">        - Accept-Language</span><br><span class="line">        - Accept-Encoding</span><br><span class="line">    ~ 限速和封禁IP</span><br><span class="line">        - 商业IP代理 ---&gt; 蘑菇代理 / 芝麻代理 / 快代理 / 讯代理 / 阿布云代理</span><br><span class="line">        - 代理池（提前放置好一堆代理，有对应的维护机制，能够动态替换掉失效代理）</span><br><span class="line">    ~ 身份验证</span><br><span class="line">        - 服务器如何识别你是否登录？</span><br><span class="line">            ~ 从请求中获取用户的身份标识</span><br><span class="line">            ~ 对于登录成功的用户，服务器通常会将用户身份标识写入浏览器本地存储</span><br><span class="line">                - Cookie</span><br><span class="line">                - localStorage / sessionStorage</span><br><span class="line">                - IndexedDB</span><br><span class="line">                ---&gt; 下次请求要带上自己的身份标识（修改请求头、修改Cookie信息）</span><br><span class="line">        - Cookie池（提前准备好多个登录用户的身份信息，轮换着使用）</span><br><span class="line">    ~ 动态内容</span><br><span class="line">        - 抓取接口</span><br><span class="line">            ~ 浏览器开发者工具 ---&gt; Network ---&gt; Fetch/XHR（异步请求）</span><br><span class="line">            ~ 专业（HTTP）抓包工具</span><br><span class="line">                - Charles / Fiddler ---&gt; 将它设置为浏览器的代理</span><br><span class="line">                - WireShark ---&gt; Ethereal ---&gt; 协议分析工具</span><br><span class="line">        - Selenium WebDriver ---&gt; 用代码驱动浏览器</span><br><span class="line">        - Puppeteer ---&gt; Pyppeteer ---&gt; Chromium</span><br><span class="line">    ~ 爬虫蜜罐</span><br><span class="line">        - Selenium ---&gt; WebElement ---&gt; is_displayed()</span><br><span class="line">    ~ 验证码</span><br><span class="line">        CAPTCHA ---&gt; 图灵测试</span><br><span class="line">        OCR ---&gt; Optical Character Recognition</span><br><span class="line">        teseract ---&gt; pytesseract</span><br><span class="line"></span><br><span class="line">        - easyocr</span><br><span class="line">        - 打码平台</span><br><span class="line">    ~ 字体反爬</span><br><span class="line">    ~ JS加密和混淆</span><br></pre></td></tr></table></figure>



<h2 id="正则表达式的应用"><a href="#正则表达式的应用" class="headerlink" title="正则表达式的应用"></a>正则表达式的应用</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> openpyxl.cell <span class="keyword">import</span> Cell</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, Alignment</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;a\s.*?href=&quot;(?P&lt;foo&gt;.*?)&quot;.*?title=&quot;(?P&lt;bar&gt;.*?)&quot;.*?&gt;&#x27;</span>)</span><br><span class="line">resp = requests.get(<span class="string">&#x27;https://www.sohu.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># finditer方法会返回一个迭代器对象</span></span><br><span class="line">iter_obj = pattern.finditer(resp.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个工作簿</span></span><br><span class="line">wb = openpyxl.Workbook()</span><br><span class="line"><span class="comment"># 获取第一个工作表</span></span><br><span class="line">sheet = wb.active</span><br><span class="line">sheet.title = <span class="string">&#x27;搜狐新闻&#x27;</span></span><br><span class="line"><span class="comment"># 修改表头单元格的宽度和高度</span></span><br><span class="line">sheet.row_dimensions[<span class="number">1</span>].height = <span class="number">35</span></span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;A&#x27;</span>].width = <span class="number">80</span></span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;B&#x27;</span>].width = <span class="number">120</span></span><br><span class="line"><span class="comment"># 向单元格写入数据</span></span><br><span class="line">sheet.cell(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;标题&#x27;</span>)</span><br><span class="line">sheet.cell(<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;链接&#x27;</span>)</span><br><span class="line"><span class="comment"># 修改指定单元格的样式</span></span><br><span class="line">font = Font(size=<span class="number">18</span>, name=<span class="string">&#x27;华文楷体&#x27;</span>, bold=<span class="literal">True</span>, color=<span class="string">&#x27;ff0000&#x27;</span>)</span><br><span class="line">alignment = Alignment(horizontal=<span class="string">&#x27;center&#x27;</span>, vertical=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> col_index <span class="keyword">in</span> <span class="string">&#x27;AB&#x27;</span>:</span><br><span class="line">    curr_cell = sheet[<span class="string">f&#x27;<span class="subst">&#123;col_index&#125;</span>1&#x27;</span>]  <span class="comment"># type: Cell</span></span><br><span class="line">    curr_cell.font = font</span><br><span class="line">    curr_cell.alignment = alignment</span><br><span class="line"><span class="comment"># 通过对迭代器对象的循环遍历可以获得Match对象</span></span><br><span class="line"><span class="keyword">for</span> index, matcher <span class="keyword">in</span> <span class="built_in">enumerate</span>(iter_obj):</span><br><span class="line">    <span class="comment"># # 获取整个a标签</span></span><br><span class="line">    <span class="comment"># print(matcher.group())</span></span><br><span class="line">    <span class="comment"># # 获取捕获组的内容</span></span><br><span class="line">    <span class="comment"># print(matcher.group(&#x27;bar&#x27;))</span></span><br><span class="line">    <span class="comment"># print(matcher.group(&#x27;foo&#x27;))</span></span><br><span class="line">    sheet.cell(index + <span class="number">2</span>, <span class="number">1</span>, matcher.group(<span class="string">&#x27;bar&#x27;</span>))</span><br><span class="line">    sheet.cell(index + <span class="number">2</span>, <span class="number">2</span>, matcher.group(<span class="string">&#x27;foo&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存工作簿</span></span><br><span class="line">wb.save(<span class="string">&#x27;爬虫数据文件.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 根据正则表达式匹配a标签的href和title属性得到一个列表</span></span><br><span class="line"><span class="comment"># anchors_list = pattern.findall(resp.text)</span></span><br><span class="line"><span class="comment"># for href, title in anchors_list:</span></span><br><span class="line"><span class="comment">#     print(href)</span></span><br><span class="line"><span class="comment">#     print(title)</span></span><br></pre></td></tr></table></figure>



<h2 id="Selenium破解爬虫蜜罐"><a href="#Selenium破解爬虫蜜罐" class="headerlink" title="Selenium破解爬虫蜜罐"></a>Selenium破解爬虫蜜罐</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 破解Selenium反爬最重要的一行代码</span></span><br><span class="line">browser.execute_cdp_cmd(<span class="string">&#x27;Page.addScriptToEvaluateOnNewDocument&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;Object.defineProperty(navigator, &quot;webdriver&quot;, &#123;get: () =&gt; undefined&#125;)&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">browser.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">anchor = browser.find_element_by_css_selector(<span class="string">&#x27;#s-top-left &gt; a:nth-child(7)&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过WebElement对象的is_displayed方法判定元素是否可见</span></span><br><span class="line"><span class="comment"># 注意：不可见的超链接一般都不能访问，因为它极有可能是一个诱使爬虫访问的蜜罐链接</span></span><br><span class="line"><span class="built_in">print</span>(anchor.is_displayed())</span><br><span class="line"><span class="built_in">print</span>(anchor.size)</span><br><span class="line"><span class="built_in">print</span>(anchor.location)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浏览器窗口截图</span></span><br><span class="line">browser.get_screenshot_as_file(<span class="string">&#x27;resources/baidu.png&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="光学文字识别"><a href="#光学文字识别" class="headerlink" title="光学文字识别"></a>光学文字识别</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"></span><br><span class="line">reader = easyocr.Reader([<span class="string">&#x27;ch_sim&#x27;</span>, <span class="string">&#x27;en&#x27;</span>], gpu=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(reader.readtext(<span class="string">&#x27;resources/idcard.jpg&#x27;</span>, detail=<span class="number">0</span>))</span><br></pre></td></tr></table></figure>



<h2 id="从页面上抠图"><a href="#从页面上抠图" class="headerlink" title="从页面上抠图"></a>从页面上抠图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">as</span> img</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFilter</span><br><span class="line"><span class="keyword">from</span> PIL.Image <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = img.<span class="built_in">open</span>(<span class="string">&#x27;resources/idcard.jpg&#x27;</span>)  <span class="comment"># type: Image</span></span><br><span class="line"><span class="built_in">print</span>(image.size)</span><br><span class="line"><span class="comment"># 使用滤镜处理图片</span></span><br><span class="line">emboss_image = image.<span class="built_in">filter</span>(ImageFilter.EMBOSS)</span><br><span class="line">emboss_image.show()</span><br><span class="line"><span class="comment"># 抠图</span></span><br><span class="line">head = image.crop((<span class="number">320</span>, <span class="number">50</span>, <span class="number">460</span>, <span class="number">235</span>))</span><br><span class="line"><span class="comment"># # 显示图片</span></span><br><span class="line"><span class="comment"># head.show()</span></span><br><span class="line"><span class="comment"># 保存图片</span></span><br><span class="line">head.save(<span class="string">&#x27;resources/head.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC%E8%99%AB%E5%9B%9E%E9%A1%BE/" data-id="cktferqw80008kwv27pb1fp5z" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/09/11/%E7%88%AC%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/09/11/%E7%88%AC51job/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/11/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%B1%A0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6(json%E6%8E%A5%E5%8F%A3)/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Dary<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>