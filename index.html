<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Dary的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Dary的博客">
<meta property="og:url" content="http://dary.work/index.html">
<meta property="og:site_name" content="Dary的博客">
<meta property="og:locale">
<meta property="article:author" content="Dary">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Dary的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Dary的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://dary.work"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-线程池和进程池" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%B1%A0/" class="article-date">
  <time datetime="2021-09-11T06:29:14.761Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="线程队列"><a href="#线程队列" class="headerlink" title="线程队列"></a>线程队列</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"><span class="comment"># queue模块中的队列，只能保存一般数据或者多线程中产生的数据(多用于多线程，自带线程安全属性)，但是不能用来存储多进程中产生的数据。</span></span><br><span class="line"><span class="comment"># 队列数据结构：是容器，先进先出</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1. 队列基本用法</span></span><br><span class="line">    <span class="comment"># 1) 创建队列对象: Queue()</span></span><br><span class="line">    q = Queue()</span><br><span class="line">    <span class="comment"># 2) 添加数据(进): 队列对象.put(数据)</span></span><br><span class="line">    q.put(<span class="number">100</span>)</span><br><span class="line">    q.put(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3) 获取数据(出) - 出一个就少一个: 队列对象.get()</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;个数:&#x27;</span>, q.qsize())</span><br><span class="line">    <span class="built_in">print</span>(q.get())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;个数:&#x27;</span>, q.qsize())</span><br><span class="line">    <span class="built_in">print</span>(q.get())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;个数:&#x27;</span>, q.qsize())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4) 获取队列中元素的个数: 队列对象.qsize()</span></span><br><span class="line">    <span class="comment"># 5) 通过get获取数据的时候如果队列中没有数据，get方法会等待，直到队列中有数据，或者超时为止</span></span><br><span class="line">    <span class="comment"># 队列对象.get(timeout=超时时间)</span></span><br><span class="line">    <span class="comment"># q.get()</span></span><br></pre></td></tr></table></figure>



<h2 id="队列在多线程中的用法"><a href="#队列在多线程中的用法" class="headerlink" title="队列在多线程中的用法"></a>队列在多线程中的用法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue, Empty</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载&#x27;</span>)</span><br><span class="line">    time.sleep(randint(<span class="number">2</span>, <span class="number">9</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束&#x27;</span>)</span><br><span class="line">    q.put(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_data</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = q.get()</span><br><span class="line">        <span class="keyword">if</span> data == <span class="string">&#x27;end&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;------------处理<span class="subst">&#123;data&#125;</span>------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个线程处理数据（方式3对应的代码）</span></span><br><span class="line">    del_t = Thread(target=del_data)</span><br><span class="line">    del_t.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建子线程下载数据</span></span><br><span class="line">    names = [<span class="string">f&#x27;电影<span class="subst">&#123;x&#125;</span>&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>)]</span><br><span class="line">    ts = []      <span class="comment"># 保存下载电影的所有线程对象</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">        t = Thread(target=download, args=(name,))</span><br><span class="line">        t.start()</span><br><span class="line">        ts.append(t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 获取队列数据方式1：能做到子线程得到数据，主线程马上就处理数据，但是数据处理完程序没法结束</span></span><br><span class="line">    <span class="comment"># while True:</span></span><br><span class="line">    <span class="comment">#     data = q.get()</span></span><br><span class="line">    <span class="comment">#     print(f&#x27;------------处理&#123;data&#125;------------&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 获取队列数据方式2: 能做到子线程得到数据，主线程马上就处理数据，通过是否超时来判断数据是否处理完成</span></span><br><span class="line">    <span class="comment"># while True:</span></span><br><span class="line">    <span class="comment">#     try:</span></span><br><span class="line">    <span class="comment">#         data = q.get(timeout=5)</span></span><br><span class="line">    <span class="comment">#         print(f&#x27;------------处理&#123;data&#125;------------&#x27;)</span></span><br><span class="line">    <span class="comment">#     except Empty:</span></span><br><span class="line">    <span class="comment">#         break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 在所有下载数据的线程都结束的时候在队列中添加结束标记，在子线程中去获取队列中来处理</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> ts:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    q.put(<span class="string">&#x27;end&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="进程队列"><a href="#进程队列" class="headerlink" title="进程队列"></a>进程队列</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue, current_process</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="comment"># from queue import Queue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进程队列</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1）基本操作：</span></span><br><span class="line"><span class="string">创建队列对象：Queue()</span></span><br><span class="line"><span class="string">添加数据: 队列对象.put(数据)</span></span><br><span class="line"><span class="string">获取数据: 队列对象.get() / 队列对象.get(timeout=超时时间)   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2）注意事项：</span></span><br><span class="line"><span class="string">如果想要使用一个队列对象获取不同进程中的数据，这个队列必须通过关联进程的函数的参数传递到进程中</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name, q:Queue</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载&#x27;</span>)</span><br><span class="line">    time.sleep(randint(<span class="number">2</span>, <span class="number">9</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束&#x27;</span>)</span><br><span class="line">    q.put(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_data</span>(<span class="params">q: Queue</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = q.get()</span><br><span class="line">        <span class="keyword">if</span> data == <span class="string">&#x27;end&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;--------------处理<span class="subst">&#123;data&#125;</span>----------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 在子进程中处理数据</span></span><br><span class="line">    <span class="comment"># 2.1 创建队列对象，并且传递到子进程中</span></span><br><span class="line">    queue = Queue()</span><br><span class="line">    del_p = Process(target=del_data, args=(queue,))</span><br><span class="line">    del_p.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 下载电影</span></span><br><span class="line">    names = [<span class="string">f&#x27;电影<span class="subst">&#123;x&#125;</span>&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>)]</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">        p = Process(target=download, args=(name, queue))</span><br><span class="line">        p.start()</span><br><span class="line">        ps.append(p)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.2 等到所有的进程任务都结束在队列添加结束标记</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> ps:</span><br><span class="line">        p.join()</span><br><span class="line"></span><br><span class="line">    queue.put(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> current_thread</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(current_thread())</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 线程池的工作原理：提前创建指定个数的线程，保存到一个线程池中。</span></span><br><span class="line"><span class="comment">#               然后再往线程池中添加若干个任务，线程池自动为线程分配任务。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建线程池，确定线程池中线程的个数</span></span><br><span class="line">pool = ThreadPoolExecutor(max_workers=<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 往线程池中添加添加任务</span></span><br><span class="line">names = [<span class="string">f&#x27;电影<span class="subst">&#123;x&#125;</span>&#x27;</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) 一次添加一个任务</span></span><br><span class="line"><span class="comment"># 线程池.submit(函数, 参数1, 参数2,...)</span></span><br><span class="line"><span class="comment"># pool.submit(download, &#x27;电影0&#x27;)</span></span><br><span class="line"><span class="comment"># print(&#x27;开始时间:&#x27;, datetime.now())</span></span><br><span class="line"><span class="comment"># for name in names:</span></span><br><span class="line"><span class="comment">#     pool.submit(download, name)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 一次添加多个任务</span></span><br><span class="line"><span class="comment"># 线程池.map(函数, 包含所有任务的参数的序列)</span></span><br><span class="line">pool.<span class="built_in">map</span>(download, names)</span><br><span class="line"></span><br><span class="line">pool.submit(download, <span class="string">&#x27;hello!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.关闭线程池</span></span><br><span class="line"><span class="comment"># 线程池.shutdown()   -   关闭线程池以后，线程池无法再添加任务，但是不影响已经添加的任务的执行</span></span><br><span class="line">pool.shutdown()</span><br><span class="line"><span class="comment"># pool.submit(download, &#x27;电影100&#x27;)</span></span><br></pre></td></tr></table></figure>



<h2 id="线程池使用的细节"><a href="#线程池使用的细节" class="headerlink" title="线程池使用的细节"></a>线程池使用的细节</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, ALL_COMPLETED, as_completed</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name, x</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>-<span class="subst">&#123;x&#125;</span>开始下载&#x27;</span>)</span><br><span class="line">    time.sleep(randint(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>-<span class="subst">&#123;x&#125;</span>下载结束&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>数据&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1.创建线程池</span></span><br><span class="line">    pool = ThreadPoolExecutor(max_workers=<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.添加任务</span></span><br><span class="line">    <span class="comment"># 线程池.submit(函数)  -  函数可以是有任意多个参数的函数; 返回值是一个可操作的future对象(任务对象)</span></span><br><span class="line">    <span class="comment"># 线程池.map(函数)   -  函数只能是有且只有一个参数的函数； 返回值没法控制和操作</span></span><br><span class="line">    f = pool.submit(download, <span class="string">&#x27;电影1&#x27;</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    all_task = [pool.submit(download, <span class="string">f&#x27;电影<span class="subst">&#123;x&#125;</span>&#x27;</span>, x*<span class="number">10</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># all_task = []</span></span><br><span class="line">    <span class="comment"># for x in range(100):</span></span><br><span class="line">    <span class="comment">#     f = pool.submit(download, f&#x27;电影&#123;x&#125;&#x27;, x*10)</span></span><br><span class="line">    <span class="comment">#     all_task.append(f)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.等待任务完成</span></span><br><span class="line">    <span class="comment"># wait(all_task, return_when=ALL_COMPLETED)</span></span><br><span class="line">    <span class="comment"># print(&#x27;--------------------电影下载完成--------------------&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 获取任务函数的返回值</span></span><br><span class="line">    <span class="comment"># 按照任务完成的先后顺序获取任务，并且获取已经完成的任务的结果(函数返回值)</span></span><br><span class="line">    <span class="keyword">for</span> task <span class="keyword">in</span> as_completed(all_task):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;------------<span class="subst">&#123;task.result()&#125;</span>------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;--------------------电影下载完成--------------------&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="进程池"><a href="#进程池" class="headerlink" title="进程池"></a>进程池</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载&#x27;</span>)</span><br><span class="line">    time.sleep(randint(<span class="number">1</span>, <span class="number">4</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>数据&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1. 创建进程池对象: Pool(进程数)</span></span><br><span class="line">    pool = Pool(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 添加任务</span></span><br><span class="line">    <span class="comment"># 1) 一次添加一个任务</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    a. 进程池对象.apply(函数, 参数)      -       同步(串行);进程池中的多个任务串行执行</span></span><br><span class="line"><span class="string">    b. 进程池对象.apply_async(函数, 参数)    -   异步执行(并行)；必须配合close和join一起用</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    函数 - 任务对应的函数的函数名</span></span><br><span class="line"><span class="string">    参数 - 元组；调用任务函数的时候的实参，需要多少个实参，元组中就给多少个元素</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># for x in range(20):</span></span><br><span class="line">    <span class="comment">#     pool.apply_async(download, (f&#x27;电影&#123;x&#125;&#x27;,))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2) 同时添加多个任务</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    进程池.map(函数, 参数序列)   -   序列中有多少个元素就添加多少个任务；</span></span><br><span class="line"><span class="string">                                  进程池中的任务并行， 进程池中的任务和主进程串行</span></span><br><span class="line"><span class="string">                                  </span></span><br><span class="line"><span class="string">    进程池.map_async(函数, 参数序列)     -      进程池中的任务和主进程并行执行</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    map和map_async的返回值是所有任务对应的函数的返回值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = pool.map_async(download, [(<span class="string">f&#x27;电影<span class="subst">&#123;x&#125;</span>&#x27;</span>, x*<span class="number">10</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;--------------主进程-------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 关闭进程池，阻止往进程池中添加新的任务</span></span><br><span class="line">    pool.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4.等待进程池中的任务都结束</span></span><br><span class="line">    pool.join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------------下载完成--------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取函数返回值</span></span><br><span class="line">    <span class="built_in">print</span>(result.get())</span><br></pre></td></tr></table></figure>



<h2 id="线程池爬51job"><a href="#线程池爬51job" class="headerlink" title="线程池爬51job"></a>线程池爬51job</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed, wait</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page</span>(<span class="params">page</span>):</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    url = <span class="string">f&#x27;https://search.51job.com/list/000000,000000,0000,00,9,99,python,2,<span class="subst">&#123;page&#125;</span>.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    json_data = findall(<span class="string">r&#x27;window.__SEARCH_RESULT__ =(.+?)&lt;/script&gt;&#x27;</span>, response.text)[<span class="number">0</span>]</span><br><span class="line">    dict_data = loads(json_data)</span><br><span class="line">    page_data = []</span><br><span class="line">    <span class="keyword">for</span> job <span class="keyword">in</span> dict_data[<span class="string">&#x27;engine_search_result&#x27;</span>]:</span><br><span class="line">        page_data.append(&#123;</span><br><span class="line">            <span class="string">&#x27;工作名称&#x27;</span>: job[<span class="string">&#x27;job_name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;工作详情&#x27;</span>: job[<span class="string">&#x27;job_href&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;薪资&#x27;</span>: job[<span class="string">&#x27;providesalary_text&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;工作地点&#x27;</span>: job[<span class="string">&#x27;workarea_text&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;工作年限&#x27;</span>: job[<span class="string">&#x27;workyear&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;福利待遇&#x27;</span>: job[<span class="string">&#x27;jobwelf&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;公司&#x27;</span>: job[<span class="string">&#x27;company_name&#x27;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="comment"># print(page_data)</span></span><br><span class="line">    <span class="keyword">return</span> page_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 使用线程池下载数据</span></span><br><span class="line">    pool = ThreadPoolExecutor(<span class="number">20</span>)</span><br><span class="line">    all_task = [pool.submit(get_one_page, page) <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">101</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 在主线程处理数据</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;files/python.csv&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    writer = csv.DictWriter(f, [<span class="string">&#x27;工作名称&#x27;</span>, <span class="string">&#x27;工作详情&#x27;</span>, <span class="string">&#x27;薪资&#x27;</span>, <span class="string">&#x27;工作地点&#x27;</span>, <span class="string">&#x27;工作年限&#x27;</span>, <span class="string">&#x27;福利待遇&#x27;</span>, <span class="string">&#x27;公司&#x27;</span>])</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> as_completed(all_task):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----------处理一页数据---------&#x27;</span>)</span><br><span class="line">        writer.writerows(t.result())</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%B1%A0/" data-id="cktferqwa000akwv2h5r425zb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-前端基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2021-09-11T06:29:14.746Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前端的三大工具"><a href="#前端的三大工具" class="headerlink" title="前端的三大工具"></a>前端的三大工具</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment"> 1. 网页的技术结构：HTML、CSS、JS(javascript)</span></span><br><span class="line"><span class="comment"> HTML(结构标准)    -    提供网页内容（通过不同的标签提供不同的内容）</span></span><br><span class="line"><span class="comment"> CSS(样式标准)         -       负责网页内容的样式布局</span></span><br><span class="line"><span class="comment"> JS(行为标准)     -     负责控制网页内容变化</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 2. HTML - 超文本标记语法</span></span><br><span class="line"><span class="comment"> 一个网页就是一个html，html代码一般写在可以被浏览器直接解析的html文件中</span></span><br><span class="line"><span class="comment"> 1）html基本结构：一个html标签里面包含一个head标签和一个body标签</span></span><br><span class="line"><span class="comment"> html标签   -   代表整个网页</span></span><br><span class="line"><span class="comment"> head标签   -   网页顶部负责显示网页图标和标题的部分（还负责不可见的设置性的内容）</span></span><br><span class="line"><span class="comment"> body标签   -   负责网页内容的显示</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 2）标签语法：html是通过不同的标签来提供不同的网页内容，标签从结构上来讲分为两种：</span></span><br><span class="line"><span class="comment"> a. 双标签: &lt;标签名 属性名1=属性值1 属性名2=属性值2 ...&gt;标签内容&lt;/标签名&gt;</span></span><br><span class="line"><span class="comment"> b. 单标签: &lt;标签名 属性名1=属性值1 属性名2=属性值2 ...&gt;、 &lt;标签名 属性名1=属性值1 属性名2=属性值2 .../&gt;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 说明：</span></span><br><span class="line"><span class="comment"> a. 标签名和&lt;以及&gt;之间不能有空隙（注意空隙）</span></span><br><span class="line"><span class="comment"> b. 属性值不管是什么类型的数据都必须使用双引号引起来</span></span><br><span class="line"><span class="comment"> c. 双标的标签内容可以是任何内容：包括纯文字、也可以是一个或者多个标签或者是文字和标签的混合</span></span><br><span class="line"><span class="comment"> d. 标签名不是由程序员自己创建的，而是html提供的</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- html版本说明： html表示的就是html5 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span>   </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 网页基本结构 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置网页编码方式 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 设置网页标题 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="head中的标签"><a href="#head中的标签" class="headerlink" title="head中的标签"></a>head中的标签</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 1.设置编码方式 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 2.设置网页标题 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>head中的标签<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 3.设置网页图标 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/ico&quot;</span> <span class="attr">href</span>=<span class="string">&quot;img/jd_logo.ico&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&quot;/&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;style type=&quot;text/css&quot;&gt;</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">        &lt;/style&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;script type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">        &lt;/script&gt; --&gt;</span></span><br><span class="line">  </span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="文本标签"><a href="#文本标签" class="headerlink" title="文本标签"></a>文本标签</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 1.标题标签：h1~h6 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>================1. 标题标签=================<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>一级标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>二级标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>三级标题<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>四级标题<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>五级标题<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span>&gt;</span>六级标题<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 2.段落标签: p --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>================2. 段落标签=================<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>8月10日凌晨5点，《乡村爱情变奏曲》导演周英男发长文悼念因车祸去世的于月仙，一共3200余字，读来令人泪奔。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>周英男表示，到了凌晨两点多，他仍然无法入睡，翻看和于月仙的聊天记录，回忆昔日点点滴滴，他甚至已经忘记自己是第几次落泪了。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>早在6日，周英男的姑妈因癌症去世，8日刚刚出殡，9日中午他醒来后，就收到朋友发来的消息，最初甚至还以为是噩梦。直到下午接到师父刘流的电话，才不得不面对事实。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>数据<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>分析<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 3.普通的文本标签(行内文本标签): font、span、label --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>================3. 行内文本标签=================<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>发布时间: 08-10<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>06:25<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>娱乐领域创作者<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 4.文字效果相关标签和符号 </span></span><br><span class="line"><span class="comment">        加粗：b、strong</span></span><br><span class="line"><span class="comment">        倾斜：i、em</span></span><br><span class="line"><span class="comment">        换行：br   (在代码中直接按回车换行无效)</span></span><br><span class="line"><span class="comment">        空格：&amp;nbsp;   &amp;emsp; (不是标签是符号)</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>================4. 文字效果相关标签和符号=================<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">b</span>&gt;</span>当日新增治愈出院病例44例，解除医学观察的密切接触者2488人，重症病例较前一日增加5例。<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>截至8月9日24时，据31个省（自治区、直辖市）和<span class="tag">&lt;<span class="name">b</span>&gt;</span>新疆<span class="tag">&lt;/<span class="name">b</span>&gt;</span>生产建设兵团报告，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="symbol">&amp;emsp;</span><span class="symbol">&amp;emsp;</span>现有确诊病例1702例（其中重症病例54例），<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        累计治愈出院病例<span class="tag">&lt;<span class="name">i</span>&gt;</span>87631<span class="tag">&lt;/<span class="name">i</span>&gt;</span>例，累计死亡病例<span class="tag">&lt;<span class="name">em</span>&gt;</span>4636<span class="tag">&lt;/<span class="name">em</span>&gt;</span>例，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        累计报告确诊病例93969例，现有疑似病例2例。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        累计追踪到密切<span class="tag">&lt;<span class="name">strong</span>&gt;</span>接触者<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>1131521人，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        尚在医学观察的密切接触者49980人。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="图片和超链接"><a href="#图片和超链接" class="headerlink" title="图片和超链接"></a>图片和超链接</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 1. 图片标签: img </span></span><br><span class="line"><span class="comment">         1）src属性：设置图片地址（可以是本地的，也可以是网络的）</span></span><br><span class="line"><span class="comment">         2）title属性：设置图片标题（鼠标停留在图片上才会显示）</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>--------------1. 图片标签----------------<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 显示本地图片 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/luffy4.jpg&quot;</span> <span class="attr">title</span>=<span class="string">&quot;路飞&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">title</span>=<span class="string">&quot;宝儿姐&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://img2.baidu.com/it/u=1810171082,1266198879&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg&quot;</span> &gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 2. 超链接: a --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">h1</span>&gt;</span>--------------2. 超链接----------------<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!-- 文字超链接 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         <span class="comment">&lt;!-- 图片超链接 --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.jd.com&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/baidu.ico&quot;</span> &gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.jd.com&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/baidu.ico&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">p</span>&gt;</span>一段文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 1. 无序列表: ul-li  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span> </span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span>&gt;</span>h5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">li</span>&gt;</span>UI<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 2. 有序列表: ol-li --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./img/baidu.ico&quot;</span> &gt;</span></span><br><span class="line">                python</span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/luffy4.jpg&quot;</span> &gt;</span></span><br><span class="line">                java</span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>h5<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                UI</span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="input标签"><a href="#input标签" class="headerlink" title="input标签"></a>input标签</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 1. 普通输入框 </span></span><br><span class="line"><span class="comment">         1）value属性   -   输入框中的内容</span></span><br><span class="line"><span class="comment">         2）</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;小明&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入姓名&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>  <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 自带清除按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;search&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;搜索电影,电视剧&quot;</span>/&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 2. 单选按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">id</span>=<span class="string">&quot;s1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;s1&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">id</span>=<span class="string">&quot;s2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;s2&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 3. 复选按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ins&quot;</span> <span class="attr">id</span>=<span class="string">&quot;i1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;i1&quot;</span>&gt;</span>篮球<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ins&quot;</span> <span class="attr">id</span>=<span class="string">&quot;i2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;i2&quot;</span>&gt;</span>乒乓球<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ins&quot;</span> <span class="attr">id</span>=<span class="string">&quot;i3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;i3&quot;</span>&gt;</span>羽毛球<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 4.普通按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;确定&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/kaishi.png&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 5.其他功能 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;datetime-local&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="div标签"><a href="#div标签" class="headerlink" title="div标签"></a>div标签</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- div标签：</span></span><br><span class="line"><span class="comment">        1. 作为普通双标签提供内容</span></span><br><span class="line"><span class="comment">        2. 作为一个盒子对网页中的内容进行分块、分组</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">            当日新增治愈出院病例44例，解除医学观察的密切接触者2488人，重症病例较前一日增加5例。</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">            境外输入现有确诊病例720例（其中重症病例14例），现有疑似病例1例。累计确诊病例7709例，累计治愈出院病例6989例，无死亡病例。</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="css语法"><a href="#css语法" class="headerlink" title="css语法"></a>css语法</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">css（cascading style sheet, 层叠样式表）是用来给标签添加样式和布局的</span></span><br><span class="line"><span class="comment"> 1. css语法</span></span><br><span class="line"><span class="comment"> 选择器&#123;属性1:属性值1; 属性2:属性值2; ...&#125;</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 说明：</span></span><br><span class="line"><span class="comment"> 1）选择器  -   选择需要添加样式的标签。（如果是内联样式 选择器&#123;&#125; 需要省略）</span></span><br><span class="line"><span class="comment"> 2）属性   -   属性名是由css决定的，不同的属性表示不同的样式</span></span><br><span class="line"><span class="comment">              常用属性：color - 文字颜色; background-color  - 背景颜色； font-size  -  字体大小</span></span><br><span class="line"><span class="comment">                      width - 宽度；height - 高度；border  -  边框；...</span></span><br><span class="line"><span class="comment">                      </span></span><br><span class="line"><span class="comment"> 2. css代码的位置</span></span><br><span class="line"><span class="comment"> 1）内联样式表：将css代码写在标签的style属性中</span></span><br><span class="line"><span class="comment"> 2）内部样式表：将css代码写在style标签中</span></span><br><span class="line"><span class="comment"> 3）外部样式表：将css代码写在css文件中，然后再html中通过link标签导入</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 外部样式表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/index.css&quot;</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内联样式表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color: cornflowerblue; font-size: 25px;&quot;</span>&gt;</span>我是段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 内部样式 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">            <span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">color</span>: seagreen;</span></span><br><span class="line"><span class="css">                <span class="attribute">border</span>: <span class="number">1px</span> solid deeppink;</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是span1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">css文件如下：</span><br><span class="line">a&#123;</span><br><span class="line">    color: #FF1493;</span><br><span class="line">    background-color: yellowgreen;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> 选择器的作用: 选中网页中的标签</span></span><br><span class="line"><span class="comment"> 1. 标签选择器(元素选择器)  -  直接将标签名作为选择器，选中所有指定标签</span></span><br><span class="line"><span class="comment"> 例如：a&#123;&#125;  - 选中所有的a标签；  p&#123;&#125;  -  选中所有的p标签</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 2. id选择器   -   在id属性值前加#作为一个选择器，选中id属性值为指定值的标签(同一页面中id是唯一的)</span></span><br><span class="line"><span class="comment"> 例如：#p&#123;&#125; - 选中id属性值为p的标签</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 3. class选择器(类选择器)  -  在class属性值前加.作为一个选择器，选中所有class属性值是指定值的标签</span></span><br><span class="line"><span class="comment"> 例如：.p&#123;&#125;   -  选中class属性值为p的标签</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 4. 群组选择器   -   将多个选择器用逗号隔开作为一个选择器，选中用逗号隔开的每个选择器选中所有标签</span></span><br><span class="line"><span class="comment"> 例如：p,#p1,.c1&#123;&#125;   -  选中所有的p标签和id是p1的标签和class是c1的标签</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 5. 后代选择器  -  多个选择器用空格隔开</span></span><br><span class="line"><span class="comment"> 例如：div p&#123;&#125;  -  选中所有div后代的p标签（选中所有div里面的p标签）；div和p之间是后代关系</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 6. 子代选择器   -  多个选择器用&gt;隔开  </span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">            <span class="comment">/* 1. 标签选择器(元素选择器) */</span></span></span><br><span class="line"><span class="css">            <span class="comment">/* p&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: red;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            <span class="comment">/* a&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: red;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/*  2. id选择器 */</span></span></span><br><span class="line"><span class="css">            <span class="comment">/* #p1&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: #2E8B57;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/*  3. class选择器(类选择器) */</span></span></span><br><span class="line"><span class="css">            <span class="comment">/* .c1&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: red;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/* 4. 群组选择器 */</span></span></span><br><span class="line"><span class="css">            <span class="comment">/* p,.c1&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: red;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/* div p&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                background-color: yellowgreen;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/* div&gt;p&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                background-color: yellowgreen;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125;</span></span></span><br><span class="line"><span class="comment"><span class="css">            */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/* .c2&#123;</span></span></span><br><span class="line"><span class="comment"><span class="css">                color: red;</span></span></span><br><span class="line"><span class="comment"><span class="css">            &#125; */</span></span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">            <span class="comment">/* 选中同时拥有class值为c1和c2的标签 */</span></span></span><br><span class="line"><span class="css">            <span class="selector-class">.c1</span><span class="selector-class">.c2</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            </span></span><br><span class="line"><span class="css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是标题1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;c1 c3 c2&quot;</span>&gt;</span>我是段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;c2&quot;</span>&gt;</span>我超链接1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;p1&quot;</span>&gt;</span>我是段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是段落5<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;c1&quot;</span>&gt;</span></span><br><span class="line">                    我是span1</span><br><span class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是段落3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>我是超链接2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;c1&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>我是超链接3<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是段落4<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" data-id="cktferqw50003kwv2h3cc0po1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-爬瓜子二手车(json接口)" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6(json%E6%8E%A5%E5%8F%A3)/" class="article-date">
  <time datetime="2021-09-11T06:29:14.714Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="爬瓜子二手车-json接口"><a href="#爬瓜子二手车-json接口" class="headerlink" title="爬瓜子二手车(json接口)"></a>爬瓜子二手车(json接口)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">创建时间: 2021/8/16 上午9:28</span></span><br><span class="line"><span class="string">开发者: 酒坛坛儿</span></span><br><span class="line"><span class="string">Good Good Study, Day Day up !</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_data</span>():</span></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">14</span>):</span><br><span class="line">        url = <span class="string">f&#x27;https://mapi.guazi.com/car-source/carList/pcList?minor=dazhong&amp;sourceType=&amp;ec_buy_car_list_ab=&amp;location_city=&amp;district_id=&amp;tag=-1&amp;license_date=&amp;auto_type=&amp;driving_type=&amp;gearbox=&amp;road_haul=&amp;air_displacement=&amp;emission=&amp;car_color=&amp;guobie=&amp;bright_spot_config=&amp;seat=&amp;fuel_type=&amp;order=&amp;priceRange=0,-1&amp;tag_types=&amp;diff_city=&amp;intention_options=&amp;initialPriceRange=&amp;monthlyPriceRange=&amp;transfer_num=&amp;car_year=&amp;carid_qigangshu=&amp;carid_jinqixingshi=&amp;cheliangjibie=&amp;page=<span class="subst">&#123;page&#125;</span>&amp;pageSize=20&amp;city_filter=12&amp;city=12&amp;guazi_city=12&amp;qpres=&amp;versionId=0.0.0.0&amp;osv=IOS&amp;platfromSource=wap&#x27;</span></span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        data = response.json()</span><br><span class="line">        <span class="keyword">for</span> car_data <span class="keyword">in</span> data[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;postList&#x27;</span>]:</span><br><span class="line">            title = car_data[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">            license_date = car_data[<span class="string">&#x27;license_date&#x27;</span>]</span><br><span class="line">            road_haul = car_data[<span class="string">&#x27;road_haul&#x27;</span>]</span><br><span class="line">            first_pay = car_data[<span class="string">&#x27;first_pay&#x27;</span>]</span><br><span class="line">            msrp = car_data[<span class="string">&#x27;msrp&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = Chrome()</span><br><span class="line">b.get(<span class="string">&#x27;https://www.guazi.com/buy?search=%257B%2522minor%2522%253A%2522dazhong%2522%257D&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b.page_source)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6(json%E6%8E%A5%E5%8F%A3)/" data-id="cktferqw70006kwv2d9fd0gzk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-爬虫实战" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/" class="article-date">
  <time datetime="2021-09-11T06:29:14.699Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="多线程多进程总结"><a href="#多线程多进程总结" class="headerlink" title="多线程多进程总结"></a>多线程多进程总结</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">num</span>):</span></span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;子线程任务<span class="subst">&#123;num&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方案一：直接使用多线程  -  用于需要同时执行的任务个数确定并且量小(比如，一两个任务)</span></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 直接使用Thread</span></span><br><span class="line"><span class="comment"># t = Thread(target=func1, args=(1,))</span></span><br><span class="line"><span class="comment"># t.start()</span></span><br><span class="line"><span class="comment"># # join中的timeout是设置最长等待时间，如果超时子线程中的任务还没有完成，那么后面代码会直接执行（不等任务完成才执行）</span></span><br><span class="line"><span class="comment"># t.join(timeout=1)</span></span><br><span class="line"><span class="comment"># print(&#x27;------线程任务完成!-----&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 使用Thread类的子类</span></span><br><span class="line"><span class="comment"># class FThread(Thread):</span></span><br><span class="line"><span class="comment">#     def __init__(self, num):</span></span><br><span class="line"><span class="comment">#         super().__init__()</span></span><br><span class="line"><span class="comment">#         self.num = num</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     def run(self) -&gt; None:</span></span><br><span class="line"><span class="comment">#         time.sleep(1)</span></span><br><span class="line"><span class="comment">#         print(f&#x27;子线程任务&#123;self.num&#125;&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># t = FThread(1)</span></span><br><span class="line"><span class="comment"># t.start()</span></span><br><span class="line"><span class="comment"># t.join()</span></span><br><span class="line"><span class="comment"># print(&#x27;---------------任务完成----------------&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 直接使用多进程</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># class FProcess(Process):</span></span><br><span class="line"><span class="comment">#     def __init__(self, num):</span></span><br><span class="line"><span class="comment">#         super().__init__()</span></span><br><span class="line"><span class="comment">#         self.num = num</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     def run(self) -&gt; None:</span></span><br><span class="line"><span class="comment">#         time.sleep(3)</span></span><br><span class="line"><span class="comment">#         print(f&#x27;子线程任务&#123;self.num&#125;&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line"><span class="comment">#     p = Process(target=func1, args=(1,))</span></span><br><span class="line"><span class="comment">#     p.start()</span></span><br><span class="line"><span class="comment">#     # p.join()</span></span><br><span class="line"><span class="comment">#     # print(&#x27;---------------任务完成----------------&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     p2 = FProcess(2)</span></span><br><span class="line"><span class="comment">#     p2.start()</span></span><br><span class="line"><span class="comment">#     print(p2.num)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方案一、方案二数据获取问题：直接使用多线程、多进程的数据获取问题</span></span><br><span class="line"><span class="comment"># 1. 数据跨线程：定义全局变量，直接获取相关数据；（如果要用全局队列，可以用线程队列：queue模块中的Queue）</span></span><br><span class="line"><span class="comment"># 2. 数据跨进程：只能使用进程队列（multiprocessing模块中的Queue）</span></span><br><span class="line"><span class="comment"># 3. 线程队列和进程队列用法的区别</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">线程队列：</span></span><br><span class="line"><span class="string">1）定义全局队列对象</span></span><br><span class="line"><span class="string">2）添加数据：队列对象.put(数据)</span></span><br><span class="line"><span class="string">3）获取数据：队列对象.get() / 队列对象.get(timeout=超时时间)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">进程队列：</span></span><br><span class="line"><span class="string">1）定义全局队列对象</span></span><br><span class="line"><span class="string">2）添加数据：队列对象.put(数据)</span></span><br><span class="line"><span class="string">3）获取数据：队列对象.get() / 队列对象.get(timeout=超时时间)</span></span><br><span class="line"><span class="string">注意：队列对象在子进程中使用的时候必须通过进程任务对应的函数的参数来传递</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">num</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;任务<span class="subst">&#123;num&#125;</span>开始&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;子线程任务<span class="subst">&#123;num&#125;</span>完成&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&#x27;任务数据<span class="subst">&#123;num&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方案三：使用线程池</span></span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, as_completed, ALL_COMPLETED</span><br><span class="line"><span class="comment"># # 1.创建线程池</span></span><br><span class="line"><span class="comment"># pool = ThreadPoolExecutor(40)</span></span><br><span class="line"><span class="comment"># # 2.添加任务</span></span><br><span class="line"><span class="comment"># ts = [pool.submit(func2, x) for x in range(1, 101)]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 3. 关闭线程池</span></span><br><span class="line"><span class="comment"># # pool.shutdown()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 4.单纯等待线程池中所有的任务完成</span></span><br><span class="line"><span class="comment"># # wait(ts, return_when=ALL_COMPLETED)</span></span><br><span class="line"><span class="comment"># # print(&#x27;--------------所有任务都完成了------------------&#x27;)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 5. 等待任务完成的过程中实时获取数据</span></span><br><span class="line"><span class="comment"># for t in as_completed(ts):</span></span><br><span class="line"><span class="comment">#     print(t.result())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方案四：进程池</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1. 创建进程池对象</span></span><br><span class="line">    pool = Pool(<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># 2. 添加任务</span></span><br><span class="line">    <span class="comment"># 1)同步添加  - 任务和主进程中的其他任务串行执行</span></span><br><span class="line">    <span class="comment"># result1 = pool.apply(func2, (1,))</span></span><br><span class="line">    <span class="comment"># result2 = pool.map(func2, [1, 2, 3, 4, 5])</span></span><br><span class="line">    <span class="comment"># print(result1)</span></span><br><span class="line">    <span class="comment"># print(result2)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2)异步添加 - 任务和主线程中的任务同时执行（必须关键进程池并且等待，否则任务无法执行）</span></span><br><span class="line">    result1 = pool.apply_async(func2, (<span class="number">1</span>, ))</span><br><span class="line">    result2 = pool.map_async(func2, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.关闭进程池</span></span><br><span class="line">    pool.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 等待进程池中的任务都结束</span></span><br><span class="line">    pool.join()</span><br><span class="line">    <span class="built_in">print</span>(result1.get())</span><br><span class="line">    <span class="built_in">print</span>(result2.get())</span><br></pre></td></tr></table></figure>



<h2 id="爬51job详情页"><a href="#爬51job详情页" class="headerlink" title="爬51job详情页"></a>爬51job详情页</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed, wait, ALL_COMPLETED</span><br><span class="line"><span class="keyword">import</span> requests, json, csv</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page</span>(<span class="params">page: <span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;获取一页岗位信息&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 获取数据</span></span><br><span class="line">    url = <span class="string">f&#x27;https://search.51job.com/list/000000,000000,0000,00,9,99,数据分析,2,<span class="subst">&#123;page&#125;</span>.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    json_data = json.loads(findall(<span class="string">r&#x27;window.__SEARCH_RESULT__ = (.+?)&lt;/script&gt;&#x27;</span>, response.text)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析数据</span></span><br><span class="line">    page_data = []</span><br><span class="line">    <span class="keyword">for</span> job <span class="keyword">in</span> json_data[<span class="string">&#x27;engine_search_result&#x27;</span>]:</span><br><span class="line">        job_data = &#123;&#125;</span><br><span class="line">        <span class="comment"># 获取岗位相关信息</span></span><br><span class="line">        job_data[<span class="string">&#x27;name&#x27;</span>] = job[<span class="string">&#x27;job_name&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;providesalary_text&#x27;</span>] = job[<span class="string">&#x27;providesalary_text&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;workarea_text&#x27;</span>] = job[<span class="string">&#x27;workarea_text&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;company_name&#x27;</span>] = job[<span class="string">&#x27;company_name&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;companytype_text&#x27;</span>] = job[<span class="string">&#x27;companytype_text&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;workarea_text&#x27;</span>] = job[<span class="string">&#x27;workarea_text&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;job_href&#x27;</span>] = job[<span class="string">&#x27;job_href&#x27;</span>]</span><br><span class="line">        job_data[<span class="string">&#x27;jobwelf&#x27;</span>] = job[<span class="string">&#x27;jobwelf&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将工资信息中的金额分离，并且将单位统一转换成元</span></span><br><span class="line">        salary = findall(<span class="string">r&#x27;(\d+\.?\d*)-?(\d+\.?\d*)([万千])/([月年天])&#x27;</span>, job_data[<span class="string">&#x27;providesalary_text&#x27;</span>])</span><br><span class="line">        <span class="keyword">if</span> salary:</span><br><span class="line">            salary = salary[<span class="number">0</span>]</span><br><span class="line">            unit = salary[<span class="number">2</span>]</span><br><span class="line">            time = salary[<span class="number">3</span>]</span><br><span class="line">            min_salary = (<span class="built_in">float</span>(salary[<span class="number">0</span>]) * (<span class="number">10000</span> <span class="keyword">if</span> unit == <span class="string">&#x27;万&#x27;</span> <span class="keyword">else</span> <span class="number">1000</span>)) / (<span class="number">1</span> <span class="keyword">if</span> time == <span class="string">&#x27;月&#x27;</span> <span class="keyword">else</span> <span class="number">12</span>)</span><br><span class="line">            max_salary = (<span class="built_in">float</span>(salary[<span class="number">1</span>]) * (<span class="number">10000</span> <span class="keyword">if</span> unit == <span class="string">&#x27;万&#x27;</span> <span class="keyword">else</span> <span class="number">1000</span>)) / (<span class="number">1</span> <span class="keyword">if</span> time == <span class="string">&#x27;月&#x27;</span> <span class="keyword">else</span> <span class="number">12</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            min_salary = max_salary = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        job_data[<span class="string">&#x27;min_salary&#x27;</span>] = min_salary</span><br><span class="line">        job_data[<span class="string">&#x27;max_salary&#x27;</span>] = max_salary</span><br><span class="line">        job_data[<span class="string">&#x27;salary&#x27;</span>] = (min_salary + max_salary) / <span class="number">2</span></span><br><span class="line">        page_data.append(job_data)</span><br><span class="line">    <span class="keyword">return</span> page_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取每个工作的详情页(模拟)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_details_page</span>(<span class="params">data</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;请求工作的详情页：<span class="subst">&#123;data[<span class="string">&quot;job_href&quot;</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;-----------------请求成功!------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># response = requests.get(data[&quot;job_href&quot;])</span></span><br><span class="line">    <span class="comment"># response.text</span></span><br><span class="line">    <span class="comment"># data[&#x27;详情页信息字段&#x27;] = 详情页解析出的相关数据</span></span><br><span class="line">    data[<span class="string">&#x27;详情页&#x27;</span>] = <span class="string">&#x27;详情页数据&#x27;</span></span><br><span class="line">    queue.put(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_data</span>():</span></span><br><span class="line"></span><br><span class="line">    writer = csv.DictWriter(</span><br><span class="line">        <span class="built_in">open</span>(<span class="string">&#x27;files/数据分析.csv&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>),</span><br><span class="line">        [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;providesalary_text&#x27;</span>, <span class="string">&#x27;workarea_text&#x27;</span>, <span class="string">&#x27;company_name&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;companytype_text&#x27;</span>, <span class="string">&#x27;workarea_text&#x27;</span>, <span class="string">&#x27;job_href&#x27;</span>, <span class="string">&#x27;jobwelf&#x27;</span>, <span class="string">&#x27;min_salary&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;max_salary&#x27;</span>, <span class="string">&#x27;salary&#x27;</span>, <span class="string">&#x27;详情页&#x27;</span>]</span><br><span class="line">    )</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = queue.get()</span><br><span class="line">        <span class="keyword">if</span> data == <span class="string">&#x27;end&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        writer.writerow(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1.创建线程池请求每个工作的详情页</span></span><br><span class="line">    pool2 = ThreadPoolExecutor(<span class="number">50</span>)</span><br><span class="line">    ts2 = []</span><br><span class="line"></span><br><span class="line">    queue = Queue()</span><br><span class="line">    save_thread = Thread(target=save_data)</span><br><span class="line">    save_thread.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.创建线程池请求搜索结果的每一页数据</span></span><br><span class="line">    pool1 = ThreadPoolExecutor(<span class="number">50</span>)</span><br><span class="line">    ts = [pool1.submit(get_one_page, page) <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">101</span>)]</span><br><span class="line">    pool1.shutdown()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.如果请求到一个数据，就将一页数据中的50个岗位的详情请求作为任务添加到pool2中</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> as_completed(ts):</span><br><span class="line">        <span class="keyword">for</span> job <span class="keyword">in</span> t.result():</span><br><span class="line">            <span class="built_in">print</span>(job[<span class="string">&#x27;job_href&#x27;</span>])</span><br><span class="line">            t2 = pool2.submit(get_details_page, job)</span><br><span class="line">            ts2.append(t2)</span><br><span class="line">    pool2.shutdown()</span><br><span class="line"></span><br><span class="line">    wait(ts2, return_when=ALL_COMPLETED)</span><br><span class="line">    queue.put(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----------------------------------全部结束-----------------------------&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="爬京东商品评论"><a href="#爬京东商品评论" class="headerlink" title="爬京东商品评论"></a>爬京东商品评论</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, wait, ALL_COMPLETED, as_completed</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;cookie&#x27;</span>: <span class="string">&#x27;__jdv=76161171|direct|-|none|-|1628560053224; __jdu=16285600532191992332185; shshshfpb=l7hwQrGrqIi4eCr58XglTaQ%3D%3D; shshshfpa=6f4d3f44-5d90-7676-86d0-e6c4df742265-1617089801; user-key=478b38e2-62c2-4780-abdc-7ee92a3a8757; pinId=vgq34oMxHnsjt7JTMb9B0A; pin=15300022703_p; unick=jd153000xiz; _tp=SS6A2kOuyFHrS5Nm%2BHtauA%3D%3D; _pst=15300022703_p; qrsc=3; areaId=22; ipLoc-djd=22-1930-50947-0; PCSYCityID=CN_510000_510100_510107; rkv=1.0; TrackID=1erZ0XUO8xw_6hUL-f2Hc_nktnWuiTcO4mpb6IvZqKkILGf2FhGrEnjJXwSsmjbmZDcgSFyPaBnzaWacgmu38rV1O4_-kXXn13bNGTCAY6qQ8UbWIlrn9D4FEAlJ2l4Tc; thor=CCB112E41BF7B8A18299559069E1826B2FE40F79A9C40AB9CF6C7ACF4FE9B0D189CA2691BCCB844F401D55F533423E22D93DB74BC974DE5CBAD06E96E66DC8968A44F9A96268E9F0FDC91512405DD5D2CA092862CB2AA3D051F92E8B9714C2A9F110FBDA52F37F63703ECAFFD70A5E993920298C08ABB5DEC447DD3F4611CAE31BB210BC0953C98497CFCDD5B086F499; ceshi3.com=201; 3AB9D23F7A4B3C9B=MBL5WIIFBJTQE7QBGVZP75S4LKWL4F6HAICGTLHP5C7ASWPR3ARXWOZP5CCBRG5MWZV2B7IB6VAIGDPHH4XMIDMXGI; __jda=122270672.16285600532191992332185.1628560053.1628838707.1629443811.8; __jdb=122270672.8.16285600532191992332185|8.1629443811; __jdc=122270672; shshshfp=3e4645d35360fc979933ecbd8a88e64d; shshshsID=d26b51263e90f337994443223e764969_5_1629444224406&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_goods_list</span>(<span class="params">page</span>):</span></span><br><span class="line">    url = <span class="string">f&#x27;https://search.jd.com/Search?keyword=%E7%94%B5%E8%84%91&amp;wq=%E7%94%B5%E8%84%91&amp;pvid=f1269a60000642a7bdda4078a12138d6&amp;page=<span class="subst">&#123;page&#125;</span>&amp;s=56&amp;click=0&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    all_goods_li = soup.select(<span class="string">&#x27;.gl-warp&gt;li&#x27;</span>)</span><br><span class="line">    all_goods_id = []</span><br><span class="line">    <span class="keyword">for</span> goods_li <span class="keyword">in</span> all_goods_li:</span><br><span class="line">        all_goods_id.append(goods_li.attrs[<span class="string">&#x27;data-sku&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> all_goods_id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page_comments</span>(<span class="params">goods_id: <span class="built_in">str</span>, page: <span class="built_in">int</span></span>):</span></span><br><span class="line">    url = <span class="string">f&#x27;https://club.jd.com/comment/productPageComments.action?callback=fetchJSON_comment98&amp;productId=<span class="subst">&#123;goods_id&#125;</span>&amp;score=0&amp;sortType=5&amp;page=<span class="subst">&#123;page&#125;</span>&amp;pageSize=10&amp;isShadowSku=0&amp;fold=1&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    json_str = findall(<span class="string">r&#x27;fetchJSON_comment98\((.+)\)&#x27;</span>, response.text)[<span class="number">0</span>]</span><br><span class="line">    comment_info = loads(json_str)</span><br><span class="line">    comments = comment_info[<span class="string">&#x27;comments&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> comments:</span><br><span class="line">        <span class="built_in">print</span>(x[<span class="string">&#x27;content&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_goods_comments</span>(<span class="params">goods_id: <span class="built_in">str</span></span>):</span></span><br><span class="line">    url = <span class="string">f&#x27;https://club.jd.com/comment/productPageComments.action?callback=fetchJSON_comment98&amp;productId=<span class="subst">&#123;goods_id&#125;</span>&amp;score=0&amp;sortType=5&amp;page=1&amp;pageSize=10&amp;isShadowSku=0&amp;fold=1&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    json_str = findall(<span class="string">r&#x27;fetchJSON_comment98\((.+)\)&#x27;</span>, response.text)[<span class="number">0</span>]</span><br><span class="line">    comment_info = loads(json_str)</span><br><span class="line">    comment_summary = comment_info[<span class="string">&#x27;productCommentSummary&#x27;</span>]</span><br><span class="line">    count = reduce(<span class="keyword">lambda</span> x, y: x+comment_summary[<span class="string">f&#x27;score<span class="subst">&#123;y&#125;</span>Count&#x27;</span>], <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>), <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(count//<span class="number">10</span>+<span class="number">1</span>):</span><br><span class="line">        t = pool.submit(get_one_page_comments, goods_id, x)</span><br><span class="line">        ts.append(t)</span><br><span class="line"></span><br><span class="line">    pool.shutdown()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 获取评论信息的线程池</span></span><br><span class="line">    pool = ThreadPoolExecutor(<span class="number">50</span>)</span><br><span class="line">    ts = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取数据</span></span><br><span class="line">    all_goods_id = get_goods_list(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(all_goods_id)</span><br><span class="line">    get_goods_comments(all_goods_id[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    wait(ts, return_when=ALL_COMPLETED)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/" data-id="cktferqw70007kwv24toh2d72" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-爬豆瓣电影" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/" class="article-date">
  <time datetime="2021-09-11T06:29:14.699Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="爬豆瓣电影"><a href="#爬豆瓣电影" class="headerlink" title="爬豆瓣电影"></a>爬豆瓣电影</h2><h4 id="一"><a href="#一" class="headerlink" title="一"></a>一</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;fiels/douban250.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line">writer.writerow([<span class="string">&#x27;pic&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;inq&#x27;</span>, <span class="string">&#x27;rating_num&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    response = requests.get(<span class="string">f&#x27;https://movie.douban.com/top250?start=<span class="subst">&#123;i * <span class="number">25</span>&#125;</span>&amp;filter=&#x27;</span>, headers=headers)</span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    all_movie_li = soup.select(<span class="string">&#x27;#content &gt; div &gt; div.article &gt; ol &gt; li&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> all_movie_li:</span><br><span class="line">        img_url = li.select_one(<span class="string">&#x27;.pic&gt;a&gt;img&#x27;</span>).attrs[<span class="string">&#x27;src&#x27;</span>]</span><br><span class="line">        name = li.select_one(<span class="string">&#x27;.title&#x27;</span>).get_text()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            des = li.select_one(<span class="string">&#x27;.inq&#x27;</span>).get_text()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            des = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        score = li.select_one(<span class="string">&#x27;.rating_num&#x27;</span>).get_text()</span><br><span class="line">        writer.writerow([img_url, name, des, score])</span><br></pre></td></tr></table></figure>



<h4 id="二"><a href="#二" class="headerlink" title="二"></a>二</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page</span>(<span class="params">start</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;获取指定页的数据&quot;&quot;&quot;</span></span><br><span class="line">    url = <span class="string">f&#x27;https://movie.douban.com/top250?start=<span class="subst">&#123;start&#125;</span>&amp;filter=&#x27;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_page</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;获取所有页面的数据并且保存&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1.定义变量保存所有页的所有电影信息</span></span><br><span class="line">    all_data = []</span><br><span class="line">    <span class="comment"># 2. 遍历获取每一页的start值</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">226</span>, <span class="number">25</span>):</span><br><span class="line">        <span class="comment"># 获取一页数据</span></span><br><span class="line">        result = get_one_page(x)</span><br><span class="line">        <span class="comment"># 解析一页数据并且添加到大列表中</span></span><br><span class="line">        all_data += analysis_data(result)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 存储数据</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;files/豆瓣电影2.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    writer = csv.writer(f)</span><br><span class="line">    writer.writerow([<span class="string">&#x27;电影名称&#x27;</span>, <span class="string">&#x27;封面&#x27;</span>, <span class="string">&#x27;评论人数&#x27;</span>, <span class="string">&#x27;评分&#x27;</span>, <span class="string">&#x27;简介&#x27;</span>])</span><br><span class="line">    writer.writerows(all_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">analysis_data</span>(<span class="params">html: <span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;解析一页数据&quot;&quot;&quot;</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    all_li = soup.select(<span class="string">&#x27;#content &gt; div &gt; div.article &gt; ol &gt; li&#x27;</span>)</span><br><span class="line">    page_data = []</span><br><span class="line">    <span class="keyword">for</span> li <span class="keyword">in</span> all_li:</span><br><span class="line">        name = li.select_one(<span class="string">&#x27;.title&#x27;</span>).get_text()</span><br><span class="line">        img_url = li.select_one(<span class="string">&#x27;.pic img&#x27;</span>).attrs[<span class="string">&#x27;src&#x27;</span>]</span><br><span class="line">        comment_num = li.select_one(<span class="string">&#x27;.star&gt;span:nth-child(4)&#x27;</span>).get_text()[:-<span class="number">3</span>]</span><br><span class="line">        score = li.select_one(<span class="string">&#x27;.rating_num&#x27;</span>).get_text()</span><br><span class="line">        ind_node = li.select_one(<span class="string">&#x27;.inq&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> ind_node:</span><br><span class="line">            ind = ind_node.get_text()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ind = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        page_data.append([name, img_url, comment_num, score, ind])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> page_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        get_all_page()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/" data-id="cktferqwa0009kwv280s3cnpz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-爬虫回顾" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC%E8%99%AB%E5%9B%9E%E9%A1%BE/" class="article-date">
  <time datetime="2021-09-11T06:29:14.677Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 爬虫的合法性探讨</span><br><span class="line">    ~ 法不禁止即为许可</span><br><span class="line">    ~ robots协议</span><br><span class="line">    ~ 隐匿身份</span><br><span class="line">        - 高匿商业代理</span><br><span class="line">        - TOR（洋葱路由）</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 爬虫的分类</span><br><span class="line">    ~ 通用爬虫</span><br><span class="line">    ~ 定向爬虫</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 爬虫程序的一般步骤</span><br><span class="line">    URL ---&gt; Universal Resource Locator</span><br><span class="line">    URI ---&gt; Universal Resource Identifier</span><br><span class="line">    URI = URL + URN</span><br><span class="line">    协议://用户名:口令@域名或IP地址:端口/路径<span class="number">1</span>/路径<span class="number">2</span>/资源名称</span><br><span class="line">    https://www.baidu.com:<span class="number">443</span>/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png</span><br><span class="line"></span><br><span class="line">    HTTP / HTTPS ---&gt; 超文本传输协议</span><br><span class="line"></span><br><span class="line">    HTTP请求 --------&gt; 服务器</span><br><span class="line">        请求行 - 命令（GET/POST） 资源路径 协议版本</span><br><span class="line">        请求头 - 键值对</span><br><span class="line">        空行</span><br><span class="line">        消息体 - 发给服务器的数据</span><br><span class="line"></span><br><span class="line">    HTTP响应 &lt;-------- 服务器</span><br><span class="line">        响应行 - 协议版本 响应状态码</span><br><span class="line">        响应头 - 键值对</span><br><span class="line">            ~ content-<span class="built_in">type</span> ---&gt; MIME</span><br><span class="line">                - text/html</span><br><span class="line">                - application/json</span><br><span class="line">                - text/xml</span><br><span class="line">                - application/pdf</span><br><span class="line">                - image/jpeg</span><br><span class="line">                - image/png</span><br><span class="line">        空行</span><br><span class="line">        消息体 - 服务器返回的数据</span><br><span class="line"></span><br><span class="line">    ~ 抓取页面</span><br><span class="line">        - urllib</span><br><span class="line">        - requests</span><br><span class="line">            get() / post() ---&gt; Response ---&gt; text / content / json()</span><br><span class="line">            Session ---&gt; get() / post()</span><br><span class="line">    ~ 解析页面</span><br><span class="line">    ~ 数据持久化</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> HTML页面的结构</span><br><span class="line">    超文本标签语言 ---&gt; 所有的内容都放在标签下</span><br><span class="line"></span><br><span class="line">    ~ 标签：承载内容</span><br><span class="line">        &lt;p&gt; / &lt;h1&gt; / &lt;a&gt; / &lt;img&gt; / &lt;li&gt;</span><br><span class="line">    ~ CSS（Cascading Style Sheet）：页面渲染</span><br><span class="line">        选择器 ---&gt; 样式属性名: 样式属性值</span><br><span class="line">        - 标签选择器</span><br><span class="line">        - 类选择器</span><br><span class="line">        - ID选择器</span><br><span class="line">        - 父子选择器 ---&gt; div &gt; p</span><br><span class="line">        - 后代选择器 ---&gt; div p</span><br><span class="line">        - 兄弟选择器 ---&gt; div ~ p</span><br><span class="line">        - 相邻兄弟选择器 ---&gt; div + p</span><br><span class="line">        - 伪类/伪元素 ---&gt; a:visited / p:first-letter</span><br><span class="line">    ~ JavaScript（JS）：交互式行为</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 解析页面的三种方式</span><br><span class="line">    ~ 正则表达式解析 ---&gt; re</span><br><span class="line">        - 直接调用re模块的函数</span><br><span class="line">            ~ search / findall / finditer</span><br><span class="line">        - 创建Pattern对象，给对象发消息</span><br><span class="line">            ~ <span class="built_in">compile</span> ---&gt; Pattern</span><br><span class="line">            ~ search ---&gt; Match ---&gt; group()</span><br><span class="line">            ~ findall / finditer</span><br><span class="line">    ~ CSS选择器解析</span><br><span class="line">        - BeautifulSoup ---&gt; beautifulsoup4 ---&gt; <span class="keyword">import</span> bs4</span><br><span class="line">        - PyQuery ---&gt; pip install pyquery ---&gt; 有jQuery使用经验</span><br><span class="line">    ~ XPath解析</span><br><span class="line">        - lxml ---&gt; pip install lxml</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"><span class="number">6.</span> 数据持久化</span><br><span class="line">    ~ CSV文件</span><br><span class="line">    ~ Excel文件</span><br><span class="line">    ~ 数据库</span><br><span class="line">    ~ 大数据平台</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 常见的反爬方式及破解</span><br><span class="line">    ~ 请求头检查</span><br><span class="line">        - User-Agent</span><br><span class="line">        - Referer ---&gt; 网站防盗链接</span><br><span class="line">        - Accept</span><br><span class="line">        - Accept-Language</span><br><span class="line">        - Accept-Encoding</span><br><span class="line">    ~ 限速和封禁IP</span><br><span class="line">        - 商业IP代理 ---&gt; 蘑菇代理 / 芝麻代理 / 快代理 / 讯代理 / 阿布云代理</span><br><span class="line">        - 代理池（提前放置好一堆代理，有对应的维护机制，能够动态替换掉失效代理）</span><br><span class="line">    ~ 身份验证</span><br><span class="line">        - 服务器如何识别你是否登录？</span><br><span class="line">            ~ 从请求中获取用户的身份标识</span><br><span class="line">            ~ 对于登录成功的用户，服务器通常会将用户身份标识写入浏览器本地存储</span><br><span class="line">                - Cookie</span><br><span class="line">                - localStorage / sessionStorage</span><br><span class="line">                - IndexedDB</span><br><span class="line">                ---&gt; 下次请求要带上自己的身份标识（修改请求头、修改Cookie信息）</span><br><span class="line">        - Cookie池（提前准备好多个登录用户的身份信息，轮换着使用）</span><br><span class="line">    ~ 动态内容</span><br><span class="line">        - 抓取接口</span><br><span class="line">            ~ 浏览器开发者工具 ---&gt; Network ---&gt; Fetch/XHR（异步请求）</span><br><span class="line">            ~ 专业（HTTP）抓包工具</span><br><span class="line">                - Charles / Fiddler ---&gt; 将它设置为浏览器的代理</span><br><span class="line">                - WireShark ---&gt; Ethereal ---&gt; 协议分析工具</span><br><span class="line">        - Selenium WebDriver ---&gt; 用代码驱动浏览器</span><br><span class="line">        - Puppeteer ---&gt; Pyppeteer ---&gt; Chromium</span><br><span class="line">    ~ 爬虫蜜罐</span><br><span class="line">        - Selenium ---&gt; WebElement ---&gt; is_displayed()</span><br><span class="line">    ~ 验证码</span><br><span class="line">        CAPTCHA ---&gt; 图灵测试</span><br><span class="line">        OCR ---&gt; Optical Character Recognition</span><br><span class="line">        teseract ---&gt; pytesseract</span><br><span class="line"></span><br><span class="line">        - easyocr</span><br><span class="line">        - 打码平台</span><br><span class="line">    ~ 字体反爬</span><br><span class="line">    ~ JS加密和混淆</span><br><span class="line"><span class="number">6.</span> 数据持久化</span><br><span class="line">    ~ CSV文件</span><br><span class="line">    ~ Excel文件</span><br><span class="line">    ~ 数据库</span><br><span class="line">    ~ 大数据平台</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 常见的反爬方式及破解</span><br><span class="line">    ~ 请求头检查</span><br><span class="line">        - User-Agent</span><br><span class="line">        - Referer ---&gt; 网站防盗链接</span><br><span class="line">        - Accept</span><br><span class="line">        - Accept-Language</span><br><span class="line">        - Accept-Encoding</span><br><span class="line">    ~ 限速和封禁IP</span><br><span class="line">        - 商业IP代理 ---&gt; 蘑菇代理 / 芝麻代理 / 快代理 / 讯代理 / 阿布云代理</span><br><span class="line">        - 代理池（提前放置好一堆代理，有对应的维护机制，能够动态替换掉失效代理）</span><br><span class="line">    ~ 身份验证</span><br><span class="line">        - 服务器如何识别你是否登录？</span><br><span class="line">            ~ 从请求中获取用户的身份标识</span><br><span class="line">            ~ 对于登录成功的用户，服务器通常会将用户身份标识写入浏览器本地存储</span><br><span class="line">                - Cookie</span><br><span class="line">                - localStorage / sessionStorage</span><br><span class="line">                - IndexedDB</span><br><span class="line">                ---&gt; 下次请求要带上自己的身份标识（修改请求头、修改Cookie信息）</span><br><span class="line">        - Cookie池（提前准备好多个登录用户的身份信息，轮换着使用）</span><br><span class="line">    ~ 动态内容</span><br><span class="line">        - 抓取接口</span><br><span class="line">            ~ 浏览器开发者工具 ---&gt; Network ---&gt; Fetch/XHR（异步请求）</span><br><span class="line">            ~ 专业（HTTP）抓包工具</span><br><span class="line">                - Charles / Fiddler ---&gt; 将它设置为浏览器的代理</span><br><span class="line">                - WireShark ---&gt; Ethereal ---&gt; 协议分析工具</span><br><span class="line">        - Selenium WebDriver ---&gt; 用代码驱动浏览器</span><br><span class="line">        - Puppeteer ---&gt; Pyppeteer ---&gt; Chromium</span><br><span class="line">    ~ 爬虫蜜罐</span><br><span class="line">        - Selenium ---&gt; WebElement ---&gt; is_displayed()</span><br><span class="line">    ~ 验证码</span><br><span class="line">        CAPTCHA ---&gt; 图灵测试</span><br><span class="line">        OCR ---&gt; Optical Character Recognition</span><br><span class="line">        teseract ---&gt; pytesseract</span><br><span class="line"></span><br><span class="line">        - easyocr</span><br><span class="line">        - 打码平台</span><br><span class="line">    ~ 字体反爬</span><br><span class="line">    ~ JS加密和混淆</span><br></pre></td></tr></table></figure>



<h2 id="正则表达式的应用"><a href="#正则表达式的应用" class="headerlink" title="正则表达式的应用"></a>正则表达式的应用</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> openpyxl.cell <span class="keyword">import</span> Cell</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, Alignment</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;a\s.*?href=&quot;(?P&lt;foo&gt;.*?)&quot;.*?title=&quot;(?P&lt;bar&gt;.*?)&quot;.*?&gt;&#x27;</span>)</span><br><span class="line">resp = requests.get(<span class="string">&#x27;https://www.sohu.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># finditer方法会返回一个迭代器对象</span></span><br><span class="line">iter_obj = pattern.finditer(resp.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个工作簿</span></span><br><span class="line">wb = openpyxl.Workbook()</span><br><span class="line"><span class="comment"># 获取第一个工作表</span></span><br><span class="line">sheet = wb.active</span><br><span class="line">sheet.title = <span class="string">&#x27;搜狐新闻&#x27;</span></span><br><span class="line"><span class="comment"># 修改表头单元格的宽度和高度</span></span><br><span class="line">sheet.row_dimensions[<span class="number">1</span>].height = <span class="number">35</span></span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;A&#x27;</span>].width = <span class="number">80</span></span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;B&#x27;</span>].width = <span class="number">120</span></span><br><span class="line"><span class="comment"># 向单元格写入数据</span></span><br><span class="line">sheet.cell(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;标题&#x27;</span>)</span><br><span class="line">sheet.cell(<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;链接&#x27;</span>)</span><br><span class="line"><span class="comment"># 修改指定单元格的样式</span></span><br><span class="line">font = Font(size=<span class="number">18</span>, name=<span class="string">&#x27;华文楷体&#x27;</span>, bold=<span class="literal">True</span>, color=<span class="string">&#x27;ff0000&#x27;</span>)</span><br><span class="line">alignment = Alignment(horizontal=<span class="string">&#x27;center&#x27;</span>, vertical=<span class="string">&#x27;center&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> col_index <span class="keyword">in</span> <span class="string">&#x27;AB&#x27;</span>:</span><br><span class="line">    curr_cell = sheet[<span class="string">f&#x27;<span class="subst">&#123;col_index&#125;</span>1&#x27;</span>]  <span class="comment"># type: Cell</span></span><br><span class="line">    curr_cell.font = font</span><br><span class="line">    curr_cell.alignment = alignment</span><br><span class="line"><span class="comment"># 通过对迭代器对象的循环遍历可以获得Match对象</span></span><br><span class="line"><span class="keyword">for</span> index, matcher <span class="keyword">in</span> <span class="built_in">enumerate</span>(iter_obj):</span><br><span class="line">    <span class="comment"># # 获取整个a标签</span></span><br><span class="line">    <span class="comment"># print(matcher.group())</span></span><br><span class="line">    <span class="comment"># # 获取捕获组的内容</span></span><br><span class="line">    <span class="comment"># print(matcher.group(&#x27;bar&#x27;))</span></span><br><span class="line">    <span class="comment"># print(matcher.group(&#x27;foo&#x27;))</span></span><br><span class="line">    sheet.cell(index + <span class="number">2</span>, <span class="number">1</span>, matcher.group(<span class="string">&#x27;bar&#x27;</span>))</span><br><span class="line">    sheet.cell(index + <span class="number">2</span>, <span class="number">2</span>, matcher.group(<span class="string">&#x27;foo&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存工作簿</span></span><br><span class="line">wb.save(<span class="string">&#x27;爬虫数据文件.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 根据正则表达式匹配a标签的href和title属性得到一个列表</span></span><br><span class="line"><span class="comment"># anchors_list = pattern.findall(resp.text)</span></span><br><span class="line"><span class="comment"># for href, title in anchors_list:</span></span><br><span class="line"><span class="comment">#     print(href)</span></span><br><span class="line"><span class="comment">#     print(title)</span></span><br></pre></td></tr></table></figure>



<h2 id="Selenium破解爬虫蜜罐"><a href="#Selenium破解爬虫蜜罐" class="headerlink" title="Selenium破解爬虫蜜罐"></a>Selenium破解爬虫蜜罐</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 破解Selenium反爬最重要的一行代码</span></span><br><span class="line">browser.execute_cdp_cmd(<span class="string">&#x27;Page.addScriptToEvaluateOnNewDocument&#x27;</span>, &#123;</span><br><span class="line">    <span class="string">&#x27;source&#x27;</span>: <span class="string">&#x27;Object.defineProperty(navigator, &quot;webdriver&quot;, &#123;get: () =&gt; undefined&#125;)&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">browser.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">anchor = browser.find_element_by_css_selector(<span class="string">&#x27;#s-top-left &gt; a:nth-child(7)&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过WebElement对象的is_displayed方法判定元素是否可见</span></span><br><span class="line"><span class="comment"># 注意：不可见的超链接一般都不能访问，因为它极有可能是一个诱使爬虫访问的蜜罐链接</span></span><br><span class="line"><span class="built_in">print</span>(anchor.is_displayed())</span><br><span class="line"><span class="built_in">print</span>(anchor.size)</span><br><span class="line"><span class="built_in">print</span>(anchor.location)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浏览器窗口截图</span></span><br><span class="line">browser.get_screenshot_as_file(<span class="string">&#x27;resources/baidu.png&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="光学文字识别"><a href="#光学文字识别" class="headerlink" title="光学文字识别"></a>光学文字识别</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> easyocr</span><br><span class="line"></span><br><span class="line">reader = easyocr.Reader([<span class="string">&#x27;ch_sim&#x27;</span>, <span class="string">&#x27;en&#x27;</span>], gpu=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(reader.readtext(<span class="string">&#x27;resources/idcard.jpg&#x27;</span>, detail=<span class="number">0</span>))</span><br></pre></td></tr></table></figure>



<h2 id="从页面上抠图"><a href="#从页面上抠图" class="headerlink" title="从页面上抠图"></a>从页面上抠图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">as</span> img</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFilter</span><br><span class="line"><span class="keyword">from</span> PIL.Image <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = img.<span class="built_in">open</span>(<span class="string">&#x27;resources/idcard.jpg&#x27;</span>)  <span class="comment"># type: Image</span></span><br><span class="line"><span class="built_in">print</span>(image.size)</span><br><span class="line"><span class="comment"># 使用滤镜处理图片</span></span><br><span class="line">emboss_image = image.<span class="built_in">filter</span>(ImageFilter.EMBOSS)</span><br><span class="line">emboss_image.show()</span><br><span class="line"><span class="comment"># 抠图</span></span><br><span class="line">head = image.crop((<span class="number">320</span>, <span class="number">50</span>, <span class="number">460</span>, <span class="number">235</span>))</span><br><span class="line"><span class="comment"># # 显示图片</span></span><br><span class="line"><span class="comment"># head.show()</span></span><br><span class="line"><span class="comment"># 保存图片</span></span><br><span class="line">head.save(<span class="string">&#x27;resources/head.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC%E8%99%AB%E5%9B%9E%E9%A1%BE/" data-id="cktferqw80008kwv27pb1fp5z" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-爬51job" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E7%88%AC51job/" class="article-date">
  <time datetime="2021-09-11T06:29:14.661Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="爬51job"><a href="#爬51job" class="headerlink" title="爬51job"></a>爬51job</h2><h4 id="一"><a href="#一" class="headerlink" title="一"></a>一</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = Chrome()</span><br><span class="line">b_get = b.get(<span class="string">&#x27;https://www.51job.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 获取标签(输入框)</span></span><br><span class="line">search_input = b.find_element_by_id(<span class="string">&#x27;kwdselectid&#x27;</span>)</span><br><span class="line"><span class="comment"># 在输入框中输入内容</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;数据分析&#x27;</span>)</span><br><span class="line"><span class="comment"># 在输入框按回车</span></span><br><span class="line">search_input.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;files/数据分析岗位信息.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line">writer.writerow([<span class="string">&#x27;岗位&#x27;</span>, <span class="string">&#x27;公司名&#x27;</span>, <span class="string">&#x27;薪资&#x27;</span>, <span class="string">&#x27;链接&#x27;</span>])</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">176</span>:</span><br><span class="line">    soup = BeautifulSoup(b.page_source, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    all_div = soup.select(<span class="string">&#x27;body &gt; div &gt; .j_result &gt; .in &gt; .leftbox &gt; div &gt; .j_joblist &gt; .e&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> all_div:</span><br><span class="line">        name = j.select_one(<span class="string">&#x27;.t &gt; span&#x27;</span>).attrs[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        company = j.select_one(<span class="string">&#x27;.er&gt;a&#x27;</span>).attrs[<span class="string">&#x27;title&#x27;</span>]</span><br><span class="line">        money = j.select_one(<span class="string">&#x27;.el &gt; .info &gt; .sal&#x27;</span>).get_text()</span><br><span class="line">        <span class="built_in">id</span> = j.select_one(<span class="string">&#x27;.el&#x27;</span>).attrs[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        writer.writerow([name, company, money, <span class="built_in">id</span>])</span><br><span class="line">    <span class="built_in">next</span> = b.find_element_by_css_selector(<span class="string">&#x27;.next&#x27;</span>)</span><br><span class="line">    <span class="built_in">next</span>.click()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;保存完第<span class="subst">&#123;i&#125;</span>页数据&#x27;</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;已爬完&#x27;</span>)</span><br><span class="line">f.close()</span><br><span class="line">b.close()</span><br></pre></td></tr></table></figure>



<h4 id="二"><a href="#二" class="headerlink" title="二"></a>二</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time, json</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;files/数据分析.csv&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line">writer.writerow([<span class="string">&#x27;岗位&#x27;</span>, <span class="string">&#x27;薪资&#x27;</span>, <span class="string">&#x27;公司&#x27;</span>, <span class="string">&#x27;地址&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = Chrome()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_data</span>():</span></span><br><span class="line"></span><br><span class="line">    b.get(<span class="string">&#x27;https://www.51job.com/&#x27;</span>)</span><br><span class="line">    search_input = b.find_element_by_css_selector(<span class="string">&#x27;#kwdselectid&#x27;</span>)</span><br><span class="line">    search_input.send_keys(<span class="string">&#x27;数据分析&#x27;</span>)</span><br><span class="line">    search_input.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="comment"># 获取页信息</span></span><br><span class="line">        page_div = b.find_element_by_css_selector(<span class="string">&#x27;.rt.rt_page&#x27;</span>)</span><br><span class="line">        pages = page_div.text.split(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        all_page = <span class="built_in">int</span>(pages[-<span class="number">1</span>])</span><br><span class="line">        current_page = <span class="built_in">int</span>(pages[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 获取网页源代码</span></span><br><span class="line">        <span class="comment"># print(b.page_source)</span></span><br><span class="line">        save_data(b.page_source)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current_page &lt; <span class="number">10</span>:</span><br><span class="line">            <span class="built_in">next</span> = b.find_element_by_css_selector(<span class="string">&#x27;.next&#x27;</span>)</span><br><span class="line">            <span class="built_in">next</span>.click()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_data</span>(<span class="params">html: <span class="built_in">str</span></span>):</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    all_job_div = soup.select(<span class="string">&#x27;.j_joblist&gt;.e&#x27;</span>)</span><br><span class="line">    one_page_jobs = []</span><br><span class="line">    <span class="keyword">for</span> job_div <span class="keyword">in</span> all_job_div:</span><br><span class="line">        name = job_div.select_one(<span class="string">&#x27;.jname.at&#x27;</span>).get_text()</span><br><span class="line">        sal = job_div.select_one(<span class="string">&#x27;.sal&#x27;</span>).get_text()</span><br><span class="line">        company = job_div.select_one(<span class="string">&#x27;.cname.at&#x27;</span>).get_text()</span><br><span class="line">        job_url = job_div.select_one(<span class="string">&#x27;.el&#x27;</span>).attrs[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        one_page_jobs.append([name, sal, company, job_url])</span><br><span class="line">    writer.writerows(one_page_jobs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    get_net_data()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E7%88%AC51job/" data-id="cktferqw50004kwv2ad8cc3un" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-多线程与多进程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%A4%9A%E8%BF%9B%E7%A8%8B/" class="article-date">
  <time datetime="2021-09-11T06:29:14.645Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, current_thread</span><br><span class="line"></span><br><span class="line"><span class="comment"># 程序默认都是单线程（这个默认线程又叫主线程，其他的线程都叫子线程）</span></span><br><span class="line"><span class="comment"># Thread类的对象就是线程对象。程序需要多少个子线程，就创建多少个Thread的对象</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;当前线程:&#x27;</span>, current_thread())</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.单线程下载三部电影</span></span><br><span class="line"><span class="comment"># download(&#x27;大话西游&#x27;)</span></span><br><span class="line"><span class="comment"># download(&#x27;忍者神龟&#x27;)</span></span><br><span class="line"><span class="comment"># download(&#x27;黑寡妇&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.多线程下载三部电影</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">创建子线程:</span></span><br><span class="line"><span class="string">Thread(target=函数, args=元组)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">函数  -  需要在子线程中调用的函数</span></span><br><span class="line"><span class="string">元组  -  调用target对应的函数的时候传递实参列表</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 1) 创建线程对象</span></span><br><span class="line">t1 = Thread(target=download, args=(<span class="string">&#x27;大话西游&#x27;</span>,))</span><br><span class="line">t2 = Thread(target=download, args=(<span class="string">&#x27;忍者神龟&#x27;</span>,))</span><br><span class="line">t3 = Thread(target=download, args=(<span class="string">&#x27;黑寡妇&#x27;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 启动线程</span></span><br><span class="line"><span class="comment"># 线程对象.start()</span></span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t3.start()</span><br></pre></td></tr></table></figure>



<h2 id="图片下载"><a href="#图片下载" class="headerlink" title="图片下载"></a>图片下载</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"></span><br><span class="line">ts1 = []</span><br><span class="line">ts2 = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one_page</span>(<span class="params">page: <span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;获取第<span class="subst">&#123;page&#125;</span>页数据&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> page == <span class="number">1</span>:</span><br><span class="line">        url = <span class="string">&#x27;https://pic.netbian.com/index.html&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        url = <span class="string">f&#x27;https://pic.netbian.com/index_<span class="subst">&#123;page&#125;</span>.html&#x27;</span></span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    response.encoding = <span class="string">&#x27;gbk&#x27;</span></span><br><span class="line">    html = etree.HTML(response.text)</span><br><span class="line">    result = html.xpath(<span class="string">&#x27;//div[@class=&quot;slist&quot;]/ul/li/a/img/@src|//div[@class=&quot;slist&quot;]/ul/li/a/span/img/@src&#x27;</span>)</span><br><span class="line">    <span class="comment"># return [&#x27;https://pic.netbian.com&#x27;+x for x in result]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#  一页图片用一个线程来下载</span></span><br><span class="line">    t = Thread(target=download_page_image, args=([<span class="string">&#x27;https://pic.netbian.com&#x27;</span>+x <span class="keyword">for</span> x <span class="keyword">in</span> result],))</span><br><span class="line">    t.start()</span><br><span class="line">    ts1.append(t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一张图片一个线程</span></span><br><span class="line">    <span class="comment"># for url in [&#x27;https://pic.netbian.com&#x27;+x for x in result]:</span></span><br><span class="line">    <span class="comment">#     t = Thread(target=download_image, args=(url,))</span></span><br><span class="line">    <span class="comment">#     t.start()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_data</span>():</span></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">        t = Thread(target=get_one_page, args=(page, ))</span><br><span class="line">        t.start()</span><br><span class="line">        ts2.append(t)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> ts2:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> ts1:</span><br><span class="line">        t.join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;图片全部下载完成！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_page_image</span>(<span class="params">urls: <span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;下载一页数据:<span class="subst">&#123;<span class="built_in">len</span>(urls)&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">        download_image(url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_image</span>(<span class="params">url: <span class="built_in">str</span></span>):</span></span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">f&#x27;files/<span class="subst">&#123;url.split(<span class="string">&quot;/&quot;</span>)[-<span class="number">1</span>]&#125;</span>&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    f.write(response.content)</span><br><span class="line">    <span class="comment"># print(&#x27;下载完成！&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_all_data()</span><br></pre></td></tr></table></figure>



<h2 id="线程类的子对象"><a href="#线程类的子对象" class="headerlink" title="线程类的子对象"></a>线程类的子对象</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, current_thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownloadThread</span>(<span class="params">Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 在子线程中添加任务</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;self.name&#125;</span>开始下载:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;当前线程:&#x27;</span>, current_thread())</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;self.name&#125;</span>下载结束:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = DownloadThread(<span class="string">&#x27;奥特曼&#x27;</span>)</span><br><span class="line">t2 = DownloadThread(<span class="string">&#x27;葫芦娃&#x27;</span>)</span><br><span class="line">t3 = DownloadThread(<span class="string">&#x27;金刚&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过start调用run，run方法会在相应的子线程中执行</span></span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t3.start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接调用run，run方法会在主线程中执行</span></span><br><span class="line"><span class="comment"># t1.run()</span></span><br><span class="line"><span class="comment"># t2.run()</span></span><br><span class="line"><span class="comment"># t3.run()</span></span><br></pre></td></tr></table></figure>



<h2 id="join操作"><a href="#join操作" class="headerlink" title="join操作"></a>join操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, current_thread</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="comment"># join的用法：</span></span><br><span class="line"><span class="comment"># 线程对象.join()  -  等待当前线程的任务结束后才执行后面其他的代码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line">    time.sleep(randint(<span class="number">3</span>, <span class="number">7</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = Thread(target=download, args=(<span class="string">&#x27;大话西游&#x27;</span>,))</span><br><span class="line">t2 = Thread(target=download, args=(<span class="string">&#x27;忍者神龟&#x27;</span>,))</span><br><span class="line">t3 = Thread(target=download, args=(<span class="string">&#x27;黑寡妇&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t3.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line">t3.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-------------电影全部下载结束-------------&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="多进程"><a href="#多进程" class="headerlink" title="多进程"></a>多进程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">创建时间: 2021/8/17 下午3:14</span></span><br><span class="line"><span class="string">开发者: 酒坛坛儿</span></span><br><span class="line"><span class="string">Good Good Study, Day Day up !</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, current_process</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>开始下载:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;当前线程:&#x27;</span>, current_process())</span><br><span class="line">    time.sleep(randint(<span class="number">3</span>, <span class="number">7</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>下载结束:<span class="subst">&#123;datetime.now()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 1. 创建进程对象</span></span><br><span class="line">    p1 = Process(target=download, args=(<span class="string">&#x27;肖生克的救赎&#x27;</span>,))</span><br><span class="line">    p2 = Process(target=download, args=(<span class="string">&#x27;触不可及&#x27;</span>,))</span><br><span class="line">    p3 = Process(target=download, args=(<span class="string">&#x27;雪国列车&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.启动进程</span></span><br><span class="line">    p1.start()</span><br><span class="line">    p2.start()</span><br><span class="line">    p3.start()</span><br><span class="line"></span><br><span class="line">    p1.join()</span><br><span class="line">    p2.join()</span><br><span class="line">    p3.join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;电影下载完成!&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="线程间通信"><a href="#线程间通信" class="headerlink" title="线程间通信"></a>线程间通信</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.在同一个进程中的多个线程间的数据可以直接相互使用</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">100</span></span><br><span class="line">list1 = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>():</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">global</span> a</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    a = <span class="number">300</span></span><br><span class="line">    list1.append(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t = Thread(target=func1)</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line">t.join()</span><br><span class="line"><span class="built_in">print</span>(a, list1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.线程间通信的数据安全</span></span><br><span class="line"><span class="comment"># 加锁：一个数据一个锁（数据和锁需要对应）</span></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Lock, RLock</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Lock对象：锁对象.acquire()  -  加锁； 锁对象.release() - 释放锁</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">RLock对象：</span></span><br><span class="line"><span class="string">with 锁对象：</span></span><br><span class="line"><span class="string">    操作数据的代码</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;---------------------------------------&#x27;</span>)</span><br><span class="line">balance = <span class="number">10000</span></span><br><span class="line"><span class="comment"># 1) 创建锁对象，保证一个数据一个锁</span></span><br><span class="line">lock = Lock()</span><br><span class="line">lock2 = RLock()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_money</span>(<span class="params">num: <span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;存钱&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;开始存钱......&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2）在使用需要锁的数据之前加锁</span></span><br><span class="line">    <span class="comment"># lock.acquire()</span></span><br><span class="line">    <span class="keyword">with</span> lock2:</span><br><span class="line">        <span class="keyword">global</span> balance</span><br><span class="line">        b1 = balance</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        balance = b1 + num</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3) 在数据用完以后释放锁</span></span><br><span class="line">    <span class="comment"># lock.release()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw_money</span>(<span class="params">num: <span class="built_in">int</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;开始取钱......&#x27;</span>)</span><br><span class="line">    <span class="comment"># lock.acquire()</span></span><br><span class="line">    <span class="keyword">with</span> lock2:</span><br><span class="line">        <span class="keyword">global</span> balance</span><br><span class="line">        b1 = balance</span><br><span class="line">        <span class="keyword">if</span> b1 &gt;= num:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            balance = b1 - num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;余额不足!&#x27;</span>)</span><br><span class="line">    <span class="comment"># lock.release()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1 = Thread(target=save_money, args=(<span class="number">2000</span>,))</span><br><span class="line">t2 = Thread(target=draw_money, args=(<span class="number">3000</span>,))</span><br><span class="line"></span><br><span class="line">t2.start()</span><br><span class="line">t1.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;余额:&#x27;</span>, balance)</span><br></pre></td></tr></table></figure>



<h2 id="多线程数据返回问题"><a href="#多线程数据返回问题" class="headerlink" title="多线程数据返回问题"></a>多线程数据返回问题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">创建时间: 2021/8/17 下午4:39</span></span><br><span class="line"><span class="string">开发者: 酒坛坛儿</span></span><br><span class="line"><span class="string">Good Good Study, Day Day up !</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread, current_thread</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结论：在子线程中调用的函数如果有返回，这个返回值是无法在任何地方获取</span></span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">name</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;收集数据&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;-----&#x27;</span>)</span><br><span class="line">    <span class="comment"># return f&#x27;&#123;name&#125;数据&#x27;</span></span><br><span class="line">    data.append(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">use_data</span>():</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;使用<span class="subst">&#123;current_thread()&#125;</span>:&#x27;</span>, x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    t1 = Thread(target=download, args=(<span class="string">&#x27;肖生克的救赎&#x27;</span>,))</span><br><span class="line">    t2 = Thread(target=download, args=(<span class="string">&#x27;触不可及&#x27;</span>,))</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line"></span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># t3 = Thread(target=use_data)</span></span><br><span class="line">    <span class="comment"># t3.start()</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%A4%9A%E8%BF%9B%E7%A8%8B/" data-id="cktferqw60005kwv2ealj755r" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-代理和selenium" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/%E4%BB%A3%E7%90%86%E5%92%8Cselenium/" class="article-date">
  <time datetime="2021-09-11T06:29:14.614Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="使用代理ip进入网页"><a href="#使用代理ip进入网页" class="headerlink" title="使用代理ip进入网页"></a>使用代理ip进入网页</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 获取蘑菇代理中的代理IP</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip</span>():</span></span><br><span class="line">    response = requests.get(<span class="string">&#x27;http://piping.mogumiao.com/proxy/api/get_ip_bs?appKey=775206edf3dc4329ba04568b75a66a30&amp;count=4&amp;expiryDate=0&amp;format=2&amp;newLine=3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> response.text[<span class="number">0</span>] == <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;提取IP失败&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> [x <span class="keyword">for</span> x <span class="keyword">in</span> response.text.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> x]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 使用代理IP</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_data</span>():</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># &#x27;http&#x27;: &#x27;ip:端口&#x27;、&#x27;http&#x27;: &#x27;http://ip:端口&#x27;</span></span><br><span class="line">    <span class="comment"># &#x27;https&#x27;: &#x27;ip:端口&#x27;、&#x27;https&#x27;: &#x27;https://ip:端口&#x27;</span></span><br><span class="line">    ips = get_ip()</span><br><span class="line">    <span class="comment"># 判断是否提取到有效ip</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ips:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ip获取失败，等10秒以后重新运行&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    proxies = &#123;</span><br><span class="line">        <span class="string">&#x27;http&#x27;</span>: ips[<span class="number">0</span>],</span><br><span class="line">        <span class="string">&#x27;https&#x27;</span>: ips[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(<span class="string">&#x27;https://movie.douban.com/top250&#x27;</span>, headers=headers, proxies=proxies)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    get_net_data()</span><br></pre></td></tr></table></figure>



<h2 id="优化使用代理ip"><a href="#优化使用代理ip" class="headerlink" title="优化使用代理ip"></a>优化使用代理ip</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip</span>():</span></span><br><span class="line">    response = requests.get(<span class="string">&#x27;http://piping.mogumiao.com/proxy/api/get_ip_bs?appKey=775206edf3dc4329ba04568b75a66a30&amp;count=4&amp;expiryDate=0&amp;format=2&amp;newLine=3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> response.text[<span class="number">0</span>] == <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;提取IP失败&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> [x <span class="keyword">for</span> x <span class="keyword">in</span> response.text.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> x]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_data</span>():</span></span><br><span class="line">    <span class="comment"># 不断获取ip直到成功</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        ips = get_ip()</span><br><span class="line">        <span class="keyword">if</span> ips:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        time.sleep(<span class="number">5</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ip获取成功:&#x27;</span>, ips)</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    proxies = &#123;</span><br><span class="line">        <span class="string">&#x27;http&#x27;</span>: ips[<span class="number">0</span>],</span><br><span class="line">        <span class="string">&#x27;https&#x27;</span>: ips[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    url = <span class="string">&#x27;https://movie.douban.com/top250&#x27;</span></span><br><span class="line">    response = requests.get(url, headers=headers, proxies=proxies)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_net_data()</span><br></pre></td></tr></table></figure>



<h2 id="selenium的基本功能"><a href="#selenium的基本功能" class="headerlink" title="selenium的基本功能"></a>selenium的基本功能</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建浏览器对象（如果是全局变量，程序结束浏览器不会关闭；局部变量会自动关闭）</span></span><br><span class="line">b = Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 输入网址</span></span><br><span class="line">b.get(<span class="string">&#x27;https://www.jd.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 获取网页源代码</span></span><br><span class="line"><span class="built_in">print</span>(b.page_source)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭浏览器</span></span><br><span class="line"><span class="comment"># b.close()</span></span><br></pre></td></tr></table></figure>



<h2 id="selemium的常规交互"><a href="#selemium的常规交互" class="headerlink" title="selemium的常规交互"></a>selemium的常规交互</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建浏览器</span></span><br><span class="line">b = Chrome()</span><br><span class="line"><span class="comment"># 2. 打开网页</span></span><br><span class="line">b.get(<span class="string">&#x27;https://www.51job.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 获取标签(输入框)</span></span><br><span class="line"><span class="comment"># search_input = b.find_element_by_id(&#x27;kwdselectid&#x27;)</span></span><br><span class="line">search_input = b.find_element_by_css_selector(<span class="string">&#x27;#kwdselectid&#x27;</span>)</span><br><span class="line"><span class="comment"># print(search_input)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.在输入框中输入内容</span></span><br><span class="line">search_input.send_keys(<span class="string">&#x27;数据分析&#x27;</span>)</span><br><span class="line"><span class="comment"># 按输入框中按回车键</span></span><br><span class="line">search_input.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.获取网页数据</span></span><br><span class="line"><span class="built_in">print</span>(b.page_source)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------------------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line"><span class="comment"># 6. 获取下一页对应的标签</span></span><br><span class="line"><span class="built_in">next</span> = b.find_element_by_css_selector(<span class="string">&#x27;.next&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7.点击按钮</span></span><br><span class="line"><span class="built_in">next</span>.click()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;+++++++++++++++++&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(b.page_source)</span><br></pre></td></tr></table></figure>



<h2 id="selenium的常用配置"><a href="#selenium的常用配置" class="headerlink" title="selenium的常用配置"></a>selenium的常用配置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome, ChromeOptions</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip</span>():</span></span><br><span class="line">    response = requests.get(<span class="string">&#x27;http://piping.mogumiao.com/proxy/api/get_ip_bs?appKey=775206edf3dc4329ba04568b75a66a30&amp;count=4&amp;expiryDate=0&amp;format=2&amp;newLine=3&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> response.text[<span class="number">0</span>] == <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;提取IP失败&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> [x <span class="keyword">for</span> x <span class="keyword">in</span> response.text.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> x]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    ips = get_ip()</span><br><span class="line">    <span class="keyword">if</span> ips:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(ips)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建谷歌浏览器的配置对象</span></span><br><span class="line">options = ChromeOptions()</span><br><span class="line"><span class="comment"># 1) 添加取消测试环境选项</span></span><br><span class="line">options.add_experimental_option(<span class="string">&#x27;excludeSwitches&#x27;</span>, [<span class="string">&#x27;enable-automation&#x27;</span>])</span><br><span class="line"><span class="comment"># 2) 取消图片加载</span></span><br><span class="line">options.add_experimental_option(<span class="string">&quot;prefs&quot;</span>, &#123;<span class="string">&quot;profile.managed_default_content_settings.images&quot;</span>: <span class="number">2</span>&#125;)</span><br><span class="line"><span class="comment"># 3) 设置代理</span></span><br><span class="line">options.add_argument(<span class="string">f&#x27;--proxy-server=http://<span class="subst">&#123;ips[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">b = Chrome(options=options)</span><br><span class="line">b.get(<span class="string">&#x27;https://movie.douban.com/top250&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b.page_source)</span><br></pre></td></tr></table></figure>



<h2 id="获取和保存cookie"><a href="#获取和保存cookie" class="headerlink" title="获取和保存cookie"></a>获取和保存cookie</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome, ChromeOptions</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_cookie</span>():</span></span><br><span class="line">    <span class="comment"># 打开浏览器，引导到登录页面</span></span><br><span class="line">    b = Chrome()</span><br><span class="line">    b.get(<span class="string">&#x27;https://www.taobao.com&#x27;</span>)</span><br><span class="line">    search_input = b.find_element_by_id(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">    search_input.send_keys(<span class="string">&#x27;鞋子&#x27;</span>)</span><br><span class="line">    search_input.send_keys(Keys.ENTER)</span><br><span class="line">    <span class="comment"># 人工做登录操作（给足够的时间）</span></span><br><span class="line">    <span class="comment"># time.sleep(10)</span></span><br><span class="line">    <span class="built_in">input</span>(<span class="string">&#x27;是否继续：&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取cookie</span></span><br><span class="line">    cookies = b.get_cookies()</span><br><span class="line">    <span class="comment"># print(cookies, type(cookies))</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;files/taobao.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(cookies))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save_cookie()</span><br></pre></td></tr></table></figure>



<h2 id="爬淘宝"><a href="#爬淘宝" class="headerlink" title="爬淘宝"></a>爬淘宝</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome, ChromeOptions</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"></span><br><span class="line">options = ChromeOptions()</span><br><span class="line">options.add_experimental_option(<span class="string">&quot;prefs&quot;</span>, &#123;<span class="string">&quot;profile.managed_default_content_settings.images&quot;</span>: <span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用浏览器打开网页</span></span><br><span class="line">b = Chrome(options=options)</span><br><span class="line">b.get(<span class="string">&#x27;https://www.taobao.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置cookies</span></span><br><span class="line">cookies = <span class="built_in">eval</span>(<span class="built_in">open</span>(<span class="string">&#x27;files/taobao.txt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>).read())</span><br><span class="line"><span class="keyword">for</span> cookie <span class="keyword">in</span> cookies:</span><br><span class="line">    <span class="keyword">if</span> cookie[<span class="string">&#x27;secure&#x27;</span>]:</span><br><span class="line">        b.add_cookie(cookie)</span><br><span class="line"></span><br><span class="line">b.get(<span class="string">&#x27;https://www.taobao.com&#x27;</span>)</span><br><span class="line">search_input = b.find_element_by_id(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">search_input.send_keys(<span class="string">&#x27;鞋子&#x27;</span>)</span><br><span class="line">search_input.send_keys(Keys.ENTER)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/%E4%BB%A3%E7%90%86%E5%92%8Cselenium/" data-id="cktferqw40002kwv25dh18bxv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-xpath" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/09/11/xpath/" class="article-date">
  <time datetime="2021-09-11T06:29:14.599Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="xpath和xml数据格式"><a href="#xpath和xml数据格式" class="headerlink" title="xpath和xml数据格式"></a>xpath和xml数据格式</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 专业术语</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">树：整个html或xml结构</span></span><br><span class="line"><span class="string">节点：html中的每个标签，xml中标签就是节点</span></span><br><span class="line"><span class="string">根节点：树的第一个节点，html的根节点就是html标签</span></span><br><span class="line"><span class="string">属性：节点属性（html中就是标签属性）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 2.xml数据格式</span></span><br><span class="line"><span class="comment"># json数据和xml数据是两种通用的数据格式，用于不同语言之间进行数据交流</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">将一个超市的商品数据进行传输：</span></span><br><span class="line"><span class="string">json:</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    &quot;name&quot;: &quot;永辉超市&quot;,</span></span><br><span class="line"><span class="string">    &quot;address&quot;: &quot;肖家河大厦&quot;,</span></span><br><span class="line"><span class="string">    &quot;goods&quot;: [</span></span><br><span class="line"><span class="string">        &#123;&quot;name&quot;: &quot;泡面&quot;, &quot;price&quot;: 3.5, &quot;count&quot;: 20&#125;,</span></span><br><span class="line"><span class="string">        &#123;&quot;name&quot;: &quot;矿泉水&quot;, &quot;prcie&quot;: 2, &quot;count&quot;: 50&#125;,</span></span><br><span class="line"><span class="string">        &#123;&quot;name&quot;: &quot;面包&quot;, &quot;price&quot;: 5, &quot;count&quot;: 15&#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">xml:</span></span><br><span class="line"><span class="string">&lt;supermarket&gt;</span></span><br><span class="line"><span class="string">    &lt;name&gt;永辉超市&lt;/name&gt;</span></span><br><span class="line"><span class="string">    &lt;address&gt;肖家河大厦&lt;/address&gt;</span></span><br><span class="line"><span class="string">    &lt;goodsList&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;泡面&quot; price=&quot;3.5&quot; count=&quot;20&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;矿泉水&quot; price=&quot;2&quot; count=&quot;50&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;面包&quot; price=&quot;5&quot; count=&quot;15&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">    &lt;/goods&gt;</span></span><br><span class="line"><span class="string">&lt;/supermarket&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1） 准备数据</span></span><br><span class="line">xml_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;supermarket&gt;</span></span><br><span class="line"><span class="string">    &lt;name&gt;永辉超市&lt;/name&gt;</span></span><br><span class="line"><span class="string">    &lt;address&gt;肖家河大厦&lt;/address&gt;</span></span><br><span class="line"><span class="string">    &lt;goodsList&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;泡面&quot; price=&quot;3.5&quot; count=&quot;20&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;矿泉水&quot; price=&quot;2&quot; count=&quot;50&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">        &lt;goods name=&quot;面包&quot; price=&quot;5&quot; count=&quot;15&quot;&gt;&lt;/goods&gt;</span></span><br><span class="line"><span class="string">    &lt;/goodsList&gt;</span></span><br><span class="line"><span class="string">    &lt;worker_list&gt;</span></span><br><span class="line"><span class="string">        &lt;cashier name=&quot;张三&quot; pay=&quot;4000&quot;&gt;&lt;/cashier&gt;</span></span><br><span class="line"><span class="string">        &lt;shoppingGuide name=&quot;李四&quot; pay=&quot;3500&quot;&gt;&lt;/shoppingGuide&gt;</span></span><br><span class="line"><span class="string">    &lt;/worker_list&gt;</span></span><br><span class="line"><span class="string">    &lt;goods price=&quot;50&quot; count=&quot;15&quot;&gt;</span></span><br><span class="line"><span class="string">         &lt;name&gt;烟&lt;/name&gt;</span></span><br><span class="line"><span class="string">    &lt;/goods&gt;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">&lt;/supermarket&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2）创建树对象，并且获取数据的根节点</span></span><br><span class="line">supermarket = etree.XML(xml_str)</span><br><span class="line"><span class="built_in">print</span>(supermarket)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) 获取标签(获取节点)</span></span><br><span class="line"><span class="comment"># 节点对象.xpath(路径)    -     根据路径找到对应的节点，返回保存节点对象的列表</span></span><br><span class="line"><span class="comment"># a. 写绝对路径：不管xpath前面的节点对象是什么，路径从根节点开始写</span></span><br><span class="line"><span class="comment"># 写法：/绝对路径</span></span><br><span class="line">cashier = supermarket.xpath(<span class="string">&#x27;/supermarket/worker_list/cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cashier)</span><br><span class="line"></span><br><span class="line">worker_list = supermarket.xpath(<span class="string">&#x27;/supermarket/worker_list&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(worker_list)      <span class="comment"># &lt;Element worker_list at 0x105da5b40&gt;</span></span><br><span class="line"></span><br><span class="line">result = worker_list.xpath(<span class="string">&#x27;/worker_list/cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)       <span class="comment"># []</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b. 相对路径：</span></span><br><span class="line"><span class="comment"># 用.来表示当前节点，xpath前面是谁，当前节点就是谁</span></span><br><span class="line"><span class="comment"># 用..来表示当前节点的上层节点</span></span><br><span class="line"><span class="comment"># 注意：./可以省略</span></span><br><span class="line">cashier = supermarket.xpath(<span class="string">&#x27;./worker_list/cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cashier)      <span class="comment"># [&lt;Element cashier at 0x106769c00&gt;]</span></span><br><span class="line"></span><br><span class="line">cashier = worker_list.xpath(<span class="string">&#x27;./cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cashier)      <span class="comment"># [&lt;Element cashier at 0x106769c00&gt;]</span></span><br><span class="line"></span><br><span class="line">cashier = supermarket.xpath(<span class="string">&#x27;worker_list/cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cashier)      <span class="comment"># [&lt;Element cashier at 0x1047e5c80&gt;]</span></span><br><span class="line"></span><br><span class="line">cashier = worker_list.xpath(<span class="string">&#x27;cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cashier)      <span class="comment"># [&lt;Element cashier at 0x1047e5c80&gt;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c. //路径   -      从任意位置开始全局搜索</span></span><br><span class="line"><span class="comment"># 查找方式和功能和xpath前的节点无关</span></span><br><span class="line">result = supermarket.xpath(<span class="string">&#x27;//cashier&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)       <span class="comment"># [&lt;Element cashier at 0x10616ecc0&gt;]</span></span><br><span class="line"></span><br><span class="line">result = supermarket.xpath(<span class="string">&#x27;//goods&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)       <span class="comment"># [&lt;Element goods at 0x109011e40&gt;, &lt;Element goods at 0x109011e80&gt;, &lt;Element goods at 0x109011ec0&gt;, &lt;Element goods at 0x109011f00&gt;]</span></span><br><span class="line"></span><br><span class="line">result = supermarket.xpath(<span class="string">&#x27;//goodsList/goods&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4) 获取节点内容</span></span><br><span class="line"><span class="comment"># 语法：获取节点的路径/text()</span></span><br><span class="line">name = supermarket.xpath(<span class="string">&#x27;./name/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line"></span><br><span class="line">names = supermarket.xpath(<span class="string">&#x27;//name/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(names)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5) 获取节点属性值</span></span><br><span class="line"><span class="comment"># 语法：获取节点的路径/@属性名</span></span><br><span class="line">result = supermarket.xpath(<span class="string">&#x27;./goods/@price&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = supermarket.xpath(<span class="string">&#x27;//goods/@price&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>



<h2 id="解析html"><a href="#解析html" class="headerlink" title="解析html"></a>解析html</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">html = etree.HTML(<span class="built_in">open</span>(<span class="string">&#x27;test.html&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">h1 = html.xpath(<span class="string">&#x27;/html/body/h1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h1)</span><br><span class="line"></span><br><span class="line">h1 = html.xpath(<span class="string">&#x27;./body/h1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h1)</span><br><span class="line"></span><br><span class="line">h1 = html.xpath(<span class="string">&#x27;//h1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 加谓语（加条件）</span></span><br><span class="line"><span class="comment"># 语法：选中标签的路径[谓语]</span></span><br><span class="line"><span class="comment"># 1）[N]  - 获取同层的第N个标签</span></span><br><span class="line">p = html.xpath(<span class="string">&#x27;./body/p[1]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[2]/p/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2)</span></span><br><span class="line"><span class="comment"># [last()]  -  获取同层的最后一个标签</span></span><br><span class="line"><span class="comment"># [last()-N]  - 获取同层的倒数第(N+1)个</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li/p[last()-1]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[last()-1]/p[last()]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3)</span></span><br><span class="line"><span class="comment"># [position()&gt;N]</span></span><br><span class="line"><span class="comment"># [position()&lt;N]</span></span><br><span class="line"><span class="comment"># [position()&gt;=N]</span></span><br><span class="line"><span class="comment"># [position()&lt;=N]</span></span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[position()&lt;=2]/p/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[position()&gt;2]/p/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4) [@属性名]     -    获取有指定属性的标签</span></span><br><span class="line"><span class="comment"># p[@class]  - 有class属性的p标签</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div/p[@class]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [@属性名=属性值]  -  获取指定属性是指定值的标签</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div/p[@class=&quot;c1&quot;]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;//p[@class=&quot;c1&quot;]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div/p[@id=&quot;p1&quot;]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5）</span></span><br><span class="line"><span class="comment"># [标签 &gt;/&lt;/&gt;=/&lt;=/= 数据]   -   将标签按照指定子标签的内容进行筛选</span></span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[p[2]&gt;4]/p/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[p[3]&gt;30]/p[1]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li[p[1]=&quot;面包&quot;]/p/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 通配符: *</span></span><br><span class="line"><span class="comment"># 1) 表示任意标签</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div[@id=&quot;div1&quot;]/*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div[@id=&quot;div1&quot;]/*[@class]&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;//*[@class=&quot;c1&quot;]&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2）表示任意属性</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div[last()]/p[@*]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/div[last()]/p[@*=&quot;p&quot;]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">result = html.xpath(<span class="string">&#x27;//img/@*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 分支（获取若干个路径） - |</span></span><br><span class="line"><span class="comment"># 注意：一个|隔开的必须是两个独立的路径</span></span><br><span class="line">result = html.xpath(<span class="string">&#x27;./body/ul/li/p[1]/text()|./body/ul/li/p[3]/text()&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>



<h2 id="selenium和xpath爬豆瓣电影"><a href="#selenium和xpath爬豆瓣电影" class="headerlink" title="selenium和xpath爬豆瓣电影"></a>selenium和xpath爬豆瓣电影</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome, ChromeOptions</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_net_data</span>():</span></span><br><span class="line">    b = Chrome()</span><br><span class="line">    b.get(<span class="string">&quot;https://movie.douban.com/explore#!type=movie&amp;tag=%E7%83%AD%E9%97%A8&amp;sort=recommend&amp;page_limit=20&amp;page_start=0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    html = etree.HTML(b.page_source)</span><br><span class="line">    all_movie = html.xpath(<span class="string">&#x27;//div[@class=&quot;list&quot;]/a&#x27;</span>)</span><br><span class="line">    all_data = []</span><br><span class="line">    <span class="keyword">for</span> movie <span class="keyword">in</span> all_movie:</span><br><span class="line">        img_url = movie.xpath(<span class="string">&#x27;./div/img/@src&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        name = movie.xpath(<span class="string">&#x27;./div/img/@alt&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        score = movie.xpath(<span class="string">&#x27;./p/strong/text()&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        all_data.append([name, score, img_url])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> all_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_data</span>(<span class="params">data: <span class="built_in">list</span></span>):</span></span><br><span class="line">    writer = csv.writer(<span class="built_in">open</span>(<span class="string">&#x27;files/电影.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    writer.writerow([<span class="string">&#x27;名称&#x27;</span>, <span class="string">&#x27;分数&#x27;</span>, <span class="string">&#x27;封面&#x27;</span>])</span><br><span class="line">    writer.writerows(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">save_data(get_net_data())</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://dary.work/2021/09/11/xpath/" data-id="cktferqw20001kwv28hbheugz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/11/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E8%BF%9B%E7%A8%8B%E6%B1%A0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E7%93%9C%E5%AD%90%E4%BA%8C%E6%89%8B%E8%BD%A6(json%E6%8E%A5%E5%8F%A3)/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/11/%E7%88%AC%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Dary<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>